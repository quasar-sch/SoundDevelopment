<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë‚˜ì˜ ë°œë‹¬ ì¢…í•© ì‹œë®¬ë ˆì´í„°</title>
  <style>
    :root {
      font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      color:#222;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:flex-start;
      background:radial-gradient(circle at top left,#fdf3e7,#f0f6ff);
    }
    .app{
      width:100%;
      max-width:980px;
      margin:24px;
      background:#ffffffee;
      border-radius:20px;
      box-shadow:0 12px 32px rgba(0,0,0,0.08);
      padding:22px 20px 26px;
    }
    header{
      display:flex;
      gap:16px;
      align-items:center;
      margin-bottom:14px;
    }
    .hero{
      width:68px;height:68px;border-radius:50%;
      background:conic-gradient(from 180deg,#4b8cf5,#81c784,#ffb74d,#ba68c8,#4b8cf5);
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 6px 16px rgba(0,0,0,0.15);
      flex-shrink:0;
    }
    .hero span{
      width:54px;height:54px;border-radius:50%;
      background:#fff;display:flex;align-items:center;justify-content:center;
      font-size:40px;
    }
    .title-block h1{margin:0;font-size:24px;}
    .title-block .sub{margin-top:4px;font-size:13px;color:#555;}

    .stepper{margin:10px 0 16px;}
    .stepper-bar{position:relative;width:100%;height:6px;border-radius:999px;background:#e0e6f2;overflow:hidden;}
    .stepper-progress{position:absolute;top:0;left:0;height:100%;background:linear-gradient(90deg,#4b8cf5,#81c784);width:0%;transition:width .2s;}
    .stepper-labels{display:flex;justify-content:space-between;margin-top:8px;font-size:11px;color:#666;}
    .stepper-label{display:flex;align-items:center;gap:4px;}
    .step-dot{
      width:16px;height:16px;border-radius:50%;
      border:2px solid #cbd4ea;
      display:flex;align-items:center;justify-content:center;
      font-size:11px;background:#fff;color:#777;
    }
    .step-dot.active{border-color:#4b8cf5;background:#4b8cf5;color:#fff;}

    .screen{display:none;margin-top:4px;}
    .screen.active{display:block;}

    .guide{display:flex;align-items:flex-start;gap:8px;margin-bottom:10px;font-size:13px;color:#444;}
    .guide-icon{font-size:20px;}
    .guide-text{background:#f4f7ff;border-radius:12px;padding:8px 10px;border:1px solid #dde4fb;}

    h2{margin:4px 0 6px;font-size:18px;}
    .desc{font-size:13px;color:#555;margin-bottom:8px;}

    .domain-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:12px;
      margin-top:6px;
    }
    .domain-card{
      background:#fff;border-radius:16px;
      border:1px solid #e2e6f4;
      padding:10px 11px 12px;
      box-shadow:0 4px 10px rgba(0,0,0,0.04);
      font-size:13px;
    }
    .domain-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;}
    .domain-title{display:flex;align-items:center;gap:6px;font-size:14px;font-weight:600;}
    .domain-chip{font-size:11px;padding:2px 7px;border-radius:999px;background:#edf2ff;color:#3c4a8a;}
    .question-row{display:flex;gap:6px;align-items:flex-start;padding:3px 0;}
    .question-row input{margin-top:3px;}

    .quiz-card{
      background:#fff;border-radius:18px;
      border:1px solid #e1e3f0;
      padding:14px 14px 12px;
      box-shadow:0 6px 16px rgba(0,0,0,0.05);
      margin-top:4px;font-size:13px;
    }
    .quiz-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;font-size:12px;color:#666;}
    .quiz-tag{font-size:11px;padding:2px 8px;border-radius:999px;background:#fdf0ff;color:#8a3aa8;}
    .quiz-q{white-space:pre-line;font-size:14px;margin-bottom:10px;}
    .quiz-options{display:flex;flex-direction:column;gap:6px;}
    .option-card{
      border-radius:999px;border:1px solid #dde1f0;
      padding:6px 10px;
      cursor:pointer;
      display:flex;gap:6px;align-items:center;
      background:#fafbff;
      transition:border-color .15s,background .15s,transform .08s;
      font-size:13px;
    }
    .option-card span.label{font-weight:600;color:#555;}
    .option-card:hover{border-color:#b8c3f5;transform:translateY(-1px);}
    .option-card.selected{border-color:#4b8cf5;background:#eaf1ff;}
    .quiz-dots{text-align:center;margin-top:8px;font-size:11px;color:#666;}

    .quiz-nav{
      margin-top:10px;
      display:flex;
      justify-content:space-between;
      gap:8px;
      flex-wrap:wrap;
      font-size:12px;
    }
    .quiz-nav button{
      border-radius:999px;
      border:none;
      padding:6px 12px;
      font-size:13px;
      cursor:pointer;
      background:#e3e7f2;
      color:#333;
      box-shadow:none;
      transition:background .15s;
    }
    .quiz-nav button:hover{background:#d4d9ec;}
    .quiz-nav button:disabled{opacity:.5;cursor:not-allowed;}

    .habit-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:10px;margin-top:6px;
    }
    .habit-cat{
      background:#fff;border-radius:16px;
      border:1px solid #e3e7f3;
      padding:8px 10px 10px;
      box-shadow:0 4px 10px rgba(0,0,0,0.04);
      font-size:13px;
    }
    .habit-title{font-weight:600;margin-bottom:4px;}
    .habit-item{margin-top:6px;}
    .habit-text{margin-bottom:4px;}
    .habit-scale{display:flex;gap:4px;flex-wrap:wrap;}
    .habit-btn{
      border-radius:999px;border:1px solid #d4d9ea;
      padding:3px 8px;font-size:12px;
      background:#f7f8fd;cursor:pointer;
      transition:background .15s,border-color .15s;
    }
    .habit-btn.selected{background:#4b8cf5;border-color:#4b8cf5;color:#fff;}
    .habit-summary{
      margin-top:10px;background:#f5f8ff;border-radius:12px;
      padding:8px 10px;border:1px solid #dce4ff;
      font-size:12px;display:flex;justify-content:space-between;flex-wrap:wrap;gap:6px;
    }

    .result-card{
      margin-top:6px;border-radius:20px;
      overflow:hidden;box-shadow:0 10px 28px rgba(0,0,0,0.08);
      background:#fff;
    }
    .result-strip{height:42px;background:linear-gradient(90deg,#4b8cf5,#81c784,#ffb74d,#ba68c8);}
    .result-body{padding:14px 16px 16px;}
    .result-header{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:8px;}
    .result-header h3{margin:0;font-size:18px;}
    .result-sub{font-size:11px;color:#666;}
    .name-row{margin-bottom:8px;font-size:13px;display:flex;align-items:center;gap:6px;}
    .name-row input{border-radius:999px;border:1px solid #d5dae9;padding:3px 8px;font-size:12px;min-width:120px;}

    .domain-bars{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
      gap:8px;margin-bottom:10px;font-size:12px;
    }
    .domain-bar-row{display:flex;align-items:center;gap:6px;}
    .dots{letter-spacing:1px;font-size:13px;}

    .analysis{
      margin-top:6px;border-radius:12px;
      padding:8px 10px;font-size:12px;
      line-height:1.6;white-space:pre-line;
      background:#f8faff;border-left:4px solid #4b8cf5;
    }
    .analysis.secondary{background:#f7fff8;border-left-color:#81c784;}

    .strengths{
      display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:8px;margin-top:8px;font-size:12px;
    }
    .strength-box{
      border-radius:12px;padding:8px 10px;
      background:#f3fbf5;border:1px solid #cde7d4;
      white-space:pre-line;
    }
    .improve-box{
      border-radius:12px;padding:8px 10px;
      background:#fff7ec;border:1px solid #ffd4a6;
      white-space:pre-line;
    }

    .footer{
      margin-top:16px;display:flex;justify-content:space-between;align-items:center;
      gap:8px;flex-wrap:wrap;font-size:12px;color:#555;
    }
    .footer-left{max-width:60%;}
    .btn-row{display:flex;gap:8px;flex-wrap:wrap;}
    button.main-btn{
      border-radius:999px;border:none;padding:7px 15px;
      font-size:13px;cursor:pointer;
      background:#4b8cf5;color:#fff;
      box-shadow:0 4px 10px rgba(75,140,245,0.4);
      transition:background .15s,transform .08s,box-shadow .08s;
    }
    button.main-btn:hover{background:#3a78dd;transform:translateY(-1px);box-shadow:0 6px 14px rgba(75,140,245,0.45);}
    button.main-btn:disabled{opacity:.5;cursor:not-allowed;box-shadow:none;transform:none;}
    button.secondary{background:#e3e7f2;color:#333;box-shadow:none;border:none;border-radius:999px;padding:7px 15px;font-size:13px;cursor:pointer;}
    button.secondary:hover{background:#d4d9ec;}

    @media (max-width:640px){
      .app{margin:14px;padding:18px 14px 22px;}
      header{align-items:flex-start;}
      .footer-left{max-width:100%;}
    }
  </style>
</head>
<body>
<div class="app">
  <header>
    <div class="hero"><span>ğŸ§’</span></div>
    <div class="title-block">
      <h1>ë‚˜ì˜ ë°œë‹¬ ì¢…í•© ì‹œë®¬ë ˆì´í„°</h1>
      <div class="sub">5í•™ë…„ ì‹¤ê³¼ &lt;ë‚˜ì˜ ë°œë‹¬&gt; ë‹¨ì›ì„ ë°”íƒ•ìœ¼ë¡œ, ë‚˜ì˜ ì„±ì¥ê³¼ ìƒí™œìŠµê´€ì„ ëŒì•„ë³´ëŠ” ìê¸° í‰ê°€ ë„êµ¬ì…ë‹ˆë‹¤.</div>
    </div>
  </header>

  <div class="stepper">
    <div class="stepper-bar"><div id="stepProgress" class="stepper-progress"></div></div>
    <div class="stepper-labels">
      <div class="stepper-label"><div class="step-dot" data-step="1">1</div> ë‚˜ì˜ ë³€í™”</div>
      <div class="stepper-label"><div class="step-dot" data-step="2">2</div> ë°œë‹¬ ì´í•´ í€´ì¦ˆ</div>
      <div class="stepper-label"><div class="step-dot" data-step="3">3</div> ìƒí™œìŠµê´€ ì ê²€</div>
      <div class="stepper-label"><div class="step-dot" data-step="4">4</div> ê²°ê³¼ ì¹´ë“œ</div>
    </div>
  </div>

  <!-- STEP 1 -->
  <section id="step1" class="screen active">
    <div class="guide">
      <div class="guide-icon">ğŸ£</div>
      <div class="guide-text">ì§€ë‚œ 1ë…„ ë™ì•ˆ ë‹¬ë¼ì§„ ë‚˜ì˜ ëª¨ìŠµì„ ë– ì˜¬ë¦¬ë©´ì„œ, í•´ë‹¹ë˜ëŠ” ë¬¸ì¥ì„ ì²´í¬í•´ ë³´ì„¸ìš”.</div>
    </div>
    <h2>1ë‹¨ê³„. ì§€ë‚œ 1ë…„ ë™ì•ˆ, ë‚˜ëŠ” ì–´ë–»ê²Œ ìëì„ê¹Œ?</h2>
    <div class="desc">ì‹ ì²´, ìƒê°, ê°ì •, ì¹œêµ¬ ê´€ê³„ì—ì„œ ëŠë¼ëŠ” ë³€í™”ë¥¼ ê³¨ê³ ë£¨ ì‚´í´ë³´ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤. â€œê°€ë” ê·¸ëŸ° ê²ƒ ê°™ë‹¤â€ ì •ë„ì—¬ë„ ì²´í¬í•´ë„ ê´œì°®ì•„ìš”.</div>
    <div id="domainGrid" class="domain-grid"></div>
  </section>

  <!-- STEP 2 -->
  <section id="step2" class="screen">
    <div class="guide">
      <div class="guide-icon">ğŸ§©</div>
      <div class="guide-text">ìƒí™©ì„ ì½ê³ , ì–´ë–¤ ì„ íƒì´ ë‚˜ì™€ ì¹œêµ¬ì—ê²Œ ê°€ì¥ ë„ì›€ì´ ë ì§€ ìƒê°í•´ ë³´ì„¸ìš”. ì¼ë¶€ ë¬¸ì œëŠ” ê°œë…ì„ ì§ì ‘ ë¬»ê¸°ë„ í•©ë‹ˆë‹¤.</div>
    </div>
    <h2>2ë‹¨ê³„. ì´ëŸ° ìƒí™©ê³¼ ê°œë…ì—ì„œ ë‚˜ëŠ” ì–´ë–»ê²Œ ìƒê°í• ê¹Œ?</h2>
    <div class="desc">ìƒí™©í˜• + ê°œë…í˜• + í˜¼í•©í˜• ë¬¸ì œë¡œ, ì•„ë™ê¸°ì˜ ë°œë‹¬ì„ í•œ ë‹¨ê³„ ë” ê¹Šê²Œ ì´í•´í–ˆëŠ”ì§€ í™•ì¸í•´ ë´…ë‹ˆë‹¤.</div>
    <div id="quizCard" class="quiz-card"></div>
    <div id="quizDots" class="quiz-dots"></div>
    <div class="quiz-nav">
      <button id="btnQuizPrev" type="button">â—€ ì´ì „ ë¬¸ì œ</button>
      <button id="btnQuizNext" type="button">ë‹¤ìŒ ë¬¸ì œ â–¶</button>
    </div>
  </section>

  <!-- STEP 3 -->
  <section id="step3" class="screen">
    <div class="guide">
      <div class="guide-icon">ğŸŒ±</div>
      <div class="guide-text">ê±´ê°•í•œ ë°œë‹¬ì„ ìœ„í•´ ì§€ê¸ˆì˜ ìƒí™œìŠµê´€ì´ ì–´ë–¤ì§€ ì†”ì§í•˜ê²Œ ì²´í¬í•´ ë³´ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤.</div>
    </div>
    <h2>3ë‹¨ê³„. ë‚˜ì˜ ìƒí™œìŠµê´€ ì ê²€</h2>
    <div class="desc">í‰ì†Œ ìƒí™œì—ì„œ ì–¼ë§ˆë‚˜ ìì£¼ ê·¸ë ‡ê²Œ í•˜ëŠ”ì§€ ê³¨ë¼ ë³´ì„¸ìš”. ì •ë‹µÂ·ì˜¤ë‹µì´ ì•„ë‹ˆë¼, ë‚˜ë¥¼ ëŒì•„ë³´ëŠ” í™œë™ì…ë‹ˆë‹¤.</div>
    <div id="habitGrid" class="habit-grid"></div>
    <div class="habit-summary">
      <div>í˜„ì¬ê¹Œì§€ ì¶”ì • ìƒí™œìŠµê´€ ì ìˆ˜: <span id="habitPreview">0</span> / 28</div>
      <div id="habitLevel"></div>
    </div>
  </section>

  <!-- STEP 4 -->
  <section id="step4" class="screen">
    <div class="guide">
      <div class="guide-icon">ğŸ“‹</div>
      <div class="guide-text">ì§€ê¸ˆê¹Œì§€ì˜ ë‹µì„ ë°”íƒ•ìœ¼ë¡œ, ë‚˜ë§Œì˜ &lt;ë‚˜ì˜ ë°œë‹¬ ì¹´ë“œ&gt;ë¥¼ ë§Œë“¤ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤.</div>
    </div>
    <h2>4ë‹¨ê³„. ë‚˜ì˜ ë°œë‹¬ ì¹´ë“œ</h2>
    <div class="desc">í•„ìš”í•˜ë‹¤ë©´ ì´ë¦„ì„ ì ê³ , ë‚´ìš©ì„ ì½ì–´ ë³´ë©° ë‚˜ì˜ ê°•ì ê³¼ ì•ìœ¼ë¡œì˜ ëª©í‘œë¥¼ ìƒê°í•´ ë³´ì„¸ìš”.</div>

    <div class="result-card">
      <div class="result-strip"></div>
      <div class="result-body">
        <div class="result-header">
          <h3>ë‚˜ì˜ ë°œë‹¬ ì¹´ë“œ</h3>
          <div class="result-sub">5í•™ë…„ ì‹¤ê³¼ Â· ë‚˜ì˜ ë°œë‹¬</div>
        </div>
        <div class="name-row">
          ì´ë¦„: <input id="studentName" type="text" placeholder="ì´ë¦„ì„ ì ì–´ ë³´ì„¸ìš” (ì„ íƒ)">
        </div>

        <div id="domainBars" class="domain-bars"></div>

        <div id="domainAnalysis" class="analysis"></div>
        <div id="understandingAnalysis" class="analysis secondary"></div>
        <div id="habitAnalysis" class="analysis"></div>

        <div class="strengths">
          <div class="strength-box">
            <strong>â­ ë‚˜ì˜ ê°•ì  3ê°€ì§€</strong>
            <div id="strengthList"></div>
          </div>
          <div class="improve-box">
            <strong>ğŸ”§ ë³´ì™„í•˜ë©´ ì¢‹ì€ ì  2ê°€ì§€</strong>
            <div id="improveList"></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="footer">
    <div class="footer-left"><span id="stepHint">1ë‹¨ê³„: ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ í†µí•´ ë‚˜ì˜ ë³€í™”ë¥¼ ì‚´í´ë³´ëŠ” ì¤‘ì…ë‹ˆë‹¤.</span></div>
    <div class="btn-row">
      <button id="btnPrev" class="secondary" type="button" disabled>â—€ ì´ì „ ë‹¨ê³„</button>
      <button id="btnNext" class="main-btn" type="button">ë‹¤ìŒ ë‹¨ê³„ë¡œ â–¶</button>
    </div>
  </div>
</div>

<script>
(function(){
  let currentStep = 1;
  const totalSteps = 4;

  const domainsMeta = {
    physical:{label:"ì‹ ì²´ ë°œë‹¬",emoji:"ğŸ’ª"},
    cognitive:{label:"ì¸ì§€ ë°œë‹¬",emoji:"ğŸ§ "},
    emotional:{label:"ì •ì„œ ë°œë‹¬",emoji:"ğŸ’–"},
    social:{label:"ì‚¬íšŒì„± ë°œë‹¬",emoji:"ğŸ¤"}
  };

  // 1ë‹¨ê³„: ë‚˜ì˜ ë³€í™” (ì¡°ê¸ˆ ì‹¬í™”ëœ ë¬¸ì¥)
  const step1Questions = [
    {id:1,domain:"physical",text:"ì§€ë‚œ 1ë…„ ì‚¬ì´ì— í‚¤ë‚˜ ëª¸ë¬´ê²Œê°€ ëˆˆì— ë„ê²Œ ë³€í–ˆë‹¤ê³  ëŠë‚€ë‹¤."},
    {id:2,domain:"physical",text:"ì˜ˆì „ë³´ë‹¤ ì˜¤ë˜ ë‹¬ë¦¬ê±°ë‚˜ ì¤„ë„˜ê¸°ë¥¼ í•´ë„ ìˆ¨ì´ ëœ ì°¨ê³  ëœ ì§€ì¹œë‹¤."},
    {id:3,domain:"physical",text:"í”¼ê³¤í•˜ê±°ë‚˜ ì•„í”Œ ë•Œ, ì‰¬ì–´ì•¼ê² ë‹¤ëŠ” ìƒê°ì„ í•˜ê³  ìŠ¤ìŠ¤ë¡œ ì¡°ì ˆí•˜ë ¤ê³  í•œë‹¤."},
    {id:4,domain:"physical",text:"ëª¸ì˜ ë³€í™”(ê·¼ìœ¡, ì²´ë ¥, 2ì°¨ ì„±ì§• ë“±)ì— ê´€ì‹¬ì„ ê°€ì§€ê³ , ë‚´ ëª¸ì„ ì–´ë–»ê²Œ ëŒë³´ë©´ ì¢‹ì„ì§€ ìƒê°í•´ ë³¸ ì ì´ ìˆë‹¤."},

    {id:5,domain:"cognitive",text:"ì–´ë ¤ìš´ ê¸€ì´ë‚˜ ë¬¸ì œë¥¼ ì½ì„ ë•Œ, ì „ì²´ ë‚´ìš©ì„ ë¨¼ì € íŒŒì•…í•œ ë’¤ ì„¸ë¶€ ë‚´ìš©ì„ ì‚´í´ë³´ë ¤ê³  í•œë‹¤."},
    {id:6,domain:"cognitive",text:"ë¬¸ì œë¥¼ í•´ê²°í•  ë•Œ, ì‹¤íŒ¨í•œ ì´ìœ ë¥¼ ëŒì•„ë³´ê³  ë‹¤ë¥¸ ë°©ë²•ì„ ë– ì˜¬ë¦¬ë ¤ê³  í•œë‹¤."},
    {id:7,domain:"cognitive",text:"ë‰´ìŠ¤ë‚˜ ì‚¬íšŒ ë¬¸ì œë¥¼ ì ‘í–ˆì„ ë•Œ, ë‹¨ìˆœíˆ ë“£ê³  ëë‚´ì§€ ì•Šê³  ë‚´ ìƒê°ì„ ì •ë¦¬í•´ ë³´ë ¤ê³  í•œë‹¤."},
    {id:8,domain:"cognitive",text:"í•˜ë£¨ë‚˜ ì¼ì£¼ì¼ ê³„íšì„ ì„¸ì›Œ ë³´ê³ , ì‹¤ì œë¡œ ì–¼ë§ˆë‚˜ ì§€ì¼°ëŠ”ì§€ ë‹¤ì‹œ í™•ì¸í•´ ë³¸ ì ì´ ìˆë‹¤."},

    {id:9,domain:"emotional",text:"ê¸°ì¨, ìŠ¬í””, ì–µìš¸í•¨, ë¶ˆì•ˆ ë“± ì—¬ëŸ¬ ê°ì •ì´ ì„ì—¬ ìˆëŠ” ìƒíƒœë¥¼ ëŠê»´ ë³¸ ì ì´ ìˆë‹¤."},
    {id:10,domain:"emotional",text:"ê°ì •ì´ ë„ˆë¬´ ì»¤ì§€ê¸° ì „ì—, ì ì‹œ ë©ˆì¶”ê±°ë‚˜ ê¹Šê²Œ ìˆ¨ ì‰¬ëŠ” ë“± ìŠ¤ìŠ¤ë¡œë¥¼ ì§„ì •ì‹œí‚¤ë ¤ ë…¸ë ¥í•œ ì ì´ ìˆë‹¤."},
    {id:11,domain:"emotional",text:"ì¹œêµ¬ë‚˜ ê°€ì¡±ì´ í˜ë“¤ì–´í•  ë•Œ, ê·¸ ì‚¬ëŒì´ ì–´ë–¤ ê°ì •ì„ ëŠë‚„ì§€ ìƒìƒí•´ ë³´ê³  ë§ ê±¸ì–´ ì¤€ ì ì´ ìˆë‹¤."},
    {id:12,domain:"emotional",text:"í™”ê°€ ë‚  ë•Œ, ë°”ë¡œ í–‰ë™ìœ¼ë¡œ ì˜®ê¸°ê¸°ë³´ë‹¤ëŠ” ì™œ í™”ê°€ ë‚¬ëŠ”ì§€ ìƒê°í•´ ë³¸ ì ì´ ìˆë‹¤."},

    {id:13,domain:"social",text:"ì¹œêµ¬ ê´€ê³„ì—ì„œ ë‚˜ì˜ ë§ê³¼ í–‰ë™ì´ ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ ì–´ë–¤ ì˜í–¥ì„ ì¤„ì§€ ë¯¸ë¦¬ ë– ì˜¬ë ¤ ë³´ë ¤ê³  í•œë‹¤."},
    {id:14,domain:"social",text:"ëª¨ë‘  í™œë™ì—ì„œ ë‚´ ì˜ê²¬ë§Œ ì£¼ì¥í•˜ì§€ ì•Šê³ , ë‹¤ë¥¸ ì¹œêµ¬ì˜ ì˜ê²¬ ì•ˆì—ì„œë„ ì¢‹ì€ ì ì„ ì°¾ìœ¼ë ¤ê³  í•œë‹¤."},
    {id:15,domain:"social",text:"ì¹œêµ¬ì™€ ê°ˆë“±ì´ ìƒê²¼ì„ ë•Œ, ëˆ„êµ¬ íƒ“ì¸ì§€ ë”°ì§€ê¸°ë³´ë‹¤ ì–´ë–»ê²Œ í•˜ë©´ ë‹¤ì‹œ ì‚¬ì´ê°€ ì¢‹ì•„ì§ˆì§€ ìƒê°í•´ ë³¸ ì ì´ ìˆë‹¤."},
    {id:16,domain:"social",text:"ìƒˆë¡œìš´ ì¹œêµ¬ë‚˜ ë‚¯ì„  ì‚¬ëŒê³¼ë„ ì˜ˆì˜ë¥¼ ì§€í‚¤ë©° ëŒ€í™”í•˜ë ¤ê³  ë…¸ë ¥í•œë‹¤."}
  ];

  // 2ë‹¨ê³„: ì‹¬í™” í€´ì¦ˆ (ìƒí™© + ê°œë… + í˜¼í•©í˜• ì„ì–´ì„œ 8ë¬¸í•­)
  const quizData = [
    // ìƒí™©í˜•: ê°œì¸ì°¨
    {
      tag:"ìƒí™© Â· ë°œë‹¬ì˜ ê°œì¸ì°¨",
      text:"ë¯¼ì§€ëŠ” ë˜ë˜ë³´ë‹¤ í‚¤ê°€ ë¹¨ë¦¬ í¬ê³ , í”¼ë¶€ì— ì—¬ë“œë¦„ë„ ì¡°ê¸ˆì”© ë‚˜ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤.\në°˜ëŒ€ë¡œ ìˆ˜í˜„ì´ëŠ” ì•„ì§ í° ë³€í™”ê°€ ëŠê»´ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.\në¯¼ì§€ì™€ ìˆ˜í˜„ì´ê°€ 'ë°œë‹¬ì˜ ê°œì¸ì°¨'ë¥¼ ë°”ë¥´ê²Œ ì´í•´í•œ ëŒ€í™”ëŠ” ì–´ëŠ ê²ƒì¼ê¹Œìš”?",
      options:[
        "ë¯¼ì§€: 'ë‚˜ëŠ” ë„ˆë¬´ ë¹¨ë¦¬ ë³€í•´ì„œ ì´ìƒí•œê°€ ë´.' / ìˆ˜í˜„: 'ë‚˜ëŠ” ë„ˆë¬´ ëŠ¦ê²Œ ë³€í•´ì„œ ë¬¸ì œê°€ ìˆëŠ” ê²ƒ ê°™ì•„.'",
        "ë¯¼ì§€: 'ì‚¬ëŒë§ˆë‹¤ ìë¼ëŠ” ì‹œê¸°ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆì–´.' / ìˆ˜í˜„: 'ë§ì•„, ìš°ë¦¬ëŠ” ì„œë¡œ ì†ë„ê°€ ë‹¤ë¥¼ ë¿ì´ì•¼.'",
        "ë¯¼ì§€: 'ë‚´ê°€ ë” ë¹¨ë¦¬ ìëìœ¼ë‹ˆê¹Œ ë” ì–´ë¥¸ìŠ¤ëŸ¬ìš´ ê±°ì•¼.' / ìˆ˜í˜„: 'ë‚œ ì•„ì§ ì• ì•¼, ì–´ì©” ìˆ˜ ì—†ì§€.'"
      ],
      correct:1
    },
    // ê°œë…í˜•: ë°œë‹¬ì˜ ê°œì¸ì°¨ ì„¤ëª…
    {
      tag:"ê°œë… Â· ë°œë‹¬ì˜ ê°œì¸ì°¨",
      text:"ë‹¤ìŒ ì¤‘ 'ë°œë‹¬ì˜ ê°œì¸ì°¨'ì— ëŒ€í•œ ì„¤ëª…ìœ¼ë¡œ ê°€ì¥ ì•Œë§ì€ ê²ƒì€ ë¬´ì—‡ì¼ê¹Œìš”?",
      options:[
        "ëª¨ë“  ì‚¬ëŒì€ ê°™ì€ ë‚˜ì´ì— í‚¤Â·ëª¸ë¬´ê²ŒÂ·ìƒê°ì´ ê±°ì˜ ë˜‘ê°™ì´ ìë¼ì•¼ í•œë‹¤.",
        "ì–´ë–¤ ì‚¬ëŒì€ ê³„ì† ì²œì²œíˆë§Œ ìë¼ê³ , ì–´ë–¤ ì‚¬ëŒì€ ê³„ì† ë¹¨ë¦¬ë§Œ ìë¼ì„œ í‰ìƒ ì°¨ì´ê°€ ê·¸ëŒ€ë¡œ ìœ ì§€ëœë‹¤.",
        "ê°™ì€ ë‚˜ì´ì—¬ë„ ì„±ì¥ ì†ë„ì™€ ë³€í™” ì‹œê¸°ê°€ ì„œë¡œ ë‹¤ë¥¼ ìˆ˜ ìˆìœ¼ë©°, ì´ê²ƒì´ ë°˜ë“œì‹œ ì˜ëª»ë˜ê±°ë‚˜ ì´ìƒí•œ ê²ƒì€ ì•„ë‹ˆë‹¤."
      ],
      correct:2
    },
    // ìƒí™©í˜•: ê°ì • ì¡°ì ˆ + ê´€ê³„
    {
      tag:"ìƒí™© Â· ê°ì • ì¡°ì ˆê³¼ ê´€ê³„",
      text:"ë°˜ ì¹œêµ¬ë“¤ ì•ì—ì„œ ë°œí‘œë¥¼ í•˜ë˜ ì§€í˜¸ëŠ” ë§ì„ ë”ë“¬ì–´ ì‹¤ìˆ˜ë¥¼ í–ˆìŠµë‹ˆë‹¤.\nëª‡ëª‡ ì¹œêµ¬ë“¤ì´ ì›ƒì—ˆê³ , ì§€í˜¸ëŠ” ì–¼êµ´ì´ ë¹¨ê°œì§ˆ ì •ë„ë¡œ ì°½í”¼í•˜ê³  í™”ê°€ ë‚¬ìŠµë‹ˆë‹¤.\nì´ ìƒí™©ì—ì„œ ì§€í˜¸ê°€ ê°ì •ì„ ì¡°ì ˆí•˜ë©´ì„œ ì¹œêµ¬ ê´€ê³„ë„ ì§€í‚¤ëŠ” í–‰ë™ìœ¼ë¡œ ê°€ì¥ ì•Œë§ì€ ê²ƒì€ ë¬´ì—‡ì¼ê¹Œìš”?",
      options:[
        "ì›ƒì€ ì¹œêµ¬ì—ê²Œ ë°”ë¡œ ìš•ì„ í•˜ë©° í° ì†Œë¦¬ë¡œ ì‹¸ìš´ë‹¤.",
        "ì ê¹ ê¹Šê²Œ ìˆ¨ì„ ì‰¬ë©° ë§ˆìŒì„ ê°€ë¼ì•‰íŒ ë’¤, ë‚˜ì¤‘ì— ì¡°ìš©í•œ ê³³ì—ì„œ ì›ƒì—ˆë˜ ì¹œêµ¬ì—ê²Œ ê¸°ë¶„ì´ ì–´ë• ëŠ”ì§€ ë§í•´ ë³¸ë‹¤.",
        "ì•„ë¬´ë ‡ì§€ ì•Šì€ ì²™í•˜ì§€ë§Œ, ì†ìœ¼ë¡œ ê·¸ ì¹œêµ¬ë¥¼ ë‹¤ì‹œëŠ” ì•ˆ ë³´ê³  ì‹¶ë‹¤ê³  ë‹¤ì§í•œë‹¤."
      ],
      correct:1
    },
    // ê°œë…í˜•: ê°ì • ì¡°ì ˆ í–‰ë™
    {
      tag:"ê°œë… Â· ê°ì • ì¡°ì ˆ",
      text:"ë‹¤ìŒ ì¤‘ 'ê°ì •ì„ ì¡°ì ˆí•˜ë ¤ëŠ” í–‰ë™'ì´ë¼ê³  ë³´ê¸° ì–´ë ¤ìš´ ê²ƒì€ ì–´ëŠ ê²ƒì¼ê¹Œìš”?",
      options:[
        "ë„ˆë¬´ í™”ê°€ ë‚  ë•Œ, ì ì‹œ ìë¦¬ë¥¼ ë²—ì–´ë‚˜ ë¬¼ì„ ë§ˆì‹œê³  ê¹Šê²Œ ìˆ¨ì„ ì‰°ë‹¤.",
        "ìŠ¬í”ˆ ë§ˆìŒì´ ë“¤ì—ˆì„ ë•Œ, ë¯¿ì„ ìˆ˜ ìˆëŠ” ì–´ë¥¸ì´ë‚˜ ì¹œêµ¬ì—ê²Œ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆˆë‹¤.",
        "ì–µìš¸í•˜ê³  í™”ê°€ ë‚˜ì§€ë§Œ, ì•„ë¬´ì—ê²Œë„ ë§í•˜ì§€ ì•Šê³  ê³„ì† ì°¸ê¸°ë§Œ í•œë‹¤."
      ],
      correct:2
    },
    // í˜¼í•©í˜•: ë„ì›€ ìš”ì²­
    {
      tag:"ìƒí™©+ê°œë… Â· ë„ì›€ ìš”ì²­",
      text:"ë„ìœ¤ì´ëŠ” ìµœê·¼ì— ë°¤ì— ëª½ì •ì„ ê²½í—˜í–ˆìŠµë‹ˆë‹¤. ë†€ëê³  ë¶€ë„ëŸ¬ì›Œì„œ ì•„ë¬´ì—ê²Œë„ ë§í•˜ì§€ ëª»í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n'ê±´ê°•í•œ ë°œë‹¬'ê³¼ 'ì ì ˆí•œ ë„ì›€ ìš”ì²­'ì„ ëª¨ë‘ ê³ ë ¤í–ˆì„ ë•Œ, ê°€ì¥ ì•Œë§ì€ í–‰ë™ì€ ë¬´ì—‡ì¼ê¹Œìš”?",
      options:[
        "ì´ìƒí•œ ì¼ì´ë¼ê³  ìƒê°í•˜ê³  ì¸í„°ë„· ê²€ìƒ‰ë§Œ í•˜ë©° ê±±ì •í•œë‹¤.",
        "ì´ëŸ° ë³€í™”ê°€ ì•„ë™ê¸°ì˜ ìì—°ìŠ¤ëŸ¬ìš´ ê³¼ì •ì¼ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê³ , ë¯¿ì„ ìˆ˜ ìˆëŠ” ì–´ë¥¸ì—ê²Œ ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ë¬¼ì–´ë³¸ë‹¤.",
        "ì¹œêµ¬ë“¤ì—ê²Œ ì¥ë‚œì²˜ëŸ¼ ë– ë“¤ë©° ì´ì•¼ê¸°í•´ì„œ ì›ƒì–´ë„˜ê¸°ë ¤ í•œë‹¤."
      ],
      correct:1
    },
    // í˜¼í•©í˜•: ì‹ ì²´ ë†€ë¦¼ê³¼ ê³µê°
    {
      tag:"ìƒí™©+ê°œë… Â· ì‹ ì²´ ë†€ë¦¼ê³¼ ê³µê°",
      text:"ì²´ìœ¡ì‹œê°„ì— í•œ ì¹œêµ¬ì˜ ëª¸ ëƒ„ìƒˆ ë•Œë¬¸ì— ëª‡ëª‡ ì•„ì´ë“¤ì´ ë’¤ì—ì„œ ì½”ë¥¼ ë§‰ìœ¼ë©° ì›ƒì—ˆìŠµë‹ˆë‹¤.\nì´ë¥¼ ë³¸ ë‚´ê°€ í•  ìˆ˜ ìˆëŠ” í–‰ë™ìœ¼ë¡œ, 'ê³µê°'ê³¼ 'ì¡´ì¤‘'ì„ ê°€ì¥ ì˜ ì‹¤ì²œí•œ ê²ƒì€ ë¬´ì—‡ì¼ê¹Œìš”?",
      options:[
        "ì•„ë¬´ ë§ë„ í•˜ì§€ ì•Šê³ , ë‚˜ë„ ì½”ë¥¼ ë§‰ê³  ì›ƒëŠ”ë‹¤.",
        "ê·¸ ì¹œêµ¬ê°€ ìƒì²˜ë°›ì§€ ì•Šë„ë¡, ë†€ë¦¬ëŠ” ì¹œêµ¬ë“¤ì—ê²Œ ê·¸ë§Œí•˜ë¼ê³  ë§í•˜ê³  ë‚˜ì¤‘ì— ì¡°ìš©í•œ ê³³ì—ì„œ ê·¸ ì¹œêµ¬ì—ê²Œ ê´œì°®ì€ì§€ ë¬¼ì–´ë³¸ë‹¤.",
        "ì¹œêµ¬ì—ê²Œ 'ë„ˆ ì¢€ ì”»ì–´'ë¼ê³  ì†”ì§í•˜ê²Œ ë§í•´ì„œ ê³ ì¹˜ê²Œ í•œë‹¤."
      ],
      correct:1
    },
    // ê°œë…í˜•: ì‚¬íšŒì„± ë°œë‹¬
    {
      tag:"ê°œë… Â· ì‚¬íšŒì„± ë°œë‹¬",
      text:"ë‹¤ìŒ ì¤‘ 'ì‚¬íšŒì„± ë°œë‹¬'ì´ ì˜ ì´ë£¨ì–´ì§€ê³  ìˆëŠ” ëª¨ìŠµìœ¼ë¡œ ë³´ê¸° ê°€ì¥ ì–´ë ¤ìš´ ê²ƒì€ ì–´ëŠ ê²ƒì¼ê¹Œìš”?",
      options:[
        "ëª¨ë‘  í™œë™ì—ì„œ ì¹œêµ¬ì˜ ì˜ê²¬ì„ ë“¤ì€ ë’¤, ì„œë¡œì˜ ìƒê°ì„ í•©ì³ ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ ë§Œë“ ë‹¤.",
        "ì¹œêµ¬ì™€ ê°ˆë“±ì´ ìƒê²¼ì„ ë•Œ, ì„œë¡œì˜ ì…ì¥ì„ ì´ì•¼ê¸°í•˜ë©° í•´ê²°ì ì„ ì°¾ìœ¼ë ¤ê³  í•œë‹¤.",
        "ë‚´ ìƒê°ê³¼ ë‹¤ë¥´ë©´, ì¹œêµ¬ì˜ ë§ì„ ëê¹Œì§€ ë“£ì§€ ì•Šê³  ë°”ë¡œ ë¬´ì‹œí•´ ë²„ë¦°ë‹¤."
      ],
      correct:2
    },
    // í˜¼í•©í˜•: ë¯¸ë””ì–´ ì‚¬ìš©ê³¼ ì •ì„œ
    {
      tag:"ìƒí™©+ê°œë… Â· ë¯¸ë””ì–´ì™€ ì •ì„œ",
      text:"ìˆ˜ì•„ëŠ” ë°¤ë§ˆë‹¤ ë¬´ì„œìš´ ì˜ìƒì„ ë³´ê³  ìë©´ì„œ, ì•…ëª½ì„ ìì£¼ ê¾¸ê³  ì•„ì¹¨ì— í”¼ê³¤í•©ë‹ˆë‹¤.\nìˆ˜ì•„ê°€ ìì‹ ì˜ ì •ì„œì™€ ê±´ê°•ì„ ìœ„í•´ ì·¨í•´ì•¼ í•  í–‰ë™ìœ¼ë¡œ ê°€ì¥ ì•Œë§ì€ ê²ƒì€ ë¬´ì—‡ì¼ê¹Œìš”?",
      options:[
        "ë¬´ì„œìš´ ì˜ìƒì„ ê³„ì† ë³´ì§€ë§Œ, ì•…ëª½ì„ ê¿”ë„ ê·¸ëƒ¥ ì°¸ëŠ”ë‹¤.",
        "ì ìê¸° ì „ì—ëŠ” ë¬´ì„œìš´ ì˜ìƒ ëŒ€ì‹  í¸ì•ˆí•œ ìŒì•…ì´ë‚˜ ì±…ì„ ì„ íƒí•˜ê³ , í˜ë“¤ë‹¤ë©´ ë¶€ëª¨ë‹˜ê»˜ ì†”ì§í•˜ê²Œ ë§í•´ ë³¸ë‹¤.",
        "ì ì´ ì˜ ì˜¬ ë•Œê¹Œì§€ íœ´ëŒ€ì „í™”ë¥¼ ê³„ì† ë³´ë‹¤ ë³´ë©´ ì–´ëŠ ìˆœê°„ ê´œì°®ì•„ì§ˆ ê±°ë¼ê³  ë¯¿ëŠ”ë‹¤."
      ],
      correct:1
    }
  ];

  // 3ë‹¨ê³„: ìƒí™œìŠµê´€ (ì´ì „ë³´ë‹¤ í‘œí˜„ë§Œ ì•½ê°„ ì •ë¦¬)
  const habitItems = [
    {id:1,cat:"ìˆ˜ë©´Â·íœ´ì‹ ğŸ˜´",text:"ëŒ€ë¶€ë¶„ì˜ ë‚ ì—, ë°¤ì— ë¹„ìŠ·í•œ ì‹œê°„ì— ì ìë¦¬ì— ë“¤ë ¤ê³  ë…¸ë ¥í•œë‹¤."},
    {id:2,cat:"ìˆ˜ë©´Â·íœ´ì‹ ğŸ˜´",text:"ì•„ì¹¨ì— ì¼ì–´ë‚¬ì„ ë•Œ, ë„ˆë¬´ í”¼ê³¤í•´ì„œ ì¼ì–´ë‚˜ê¸° í˜ë“  ë‚ ì´ ë§ì§€ëŠ” ì•Šë‹¤."},

    {id:3,cat:"ìš´ë™Â·ê±´ê°• ğŸƒâ€â™‚ï¸",text:"ì¼ì£¼ì¼ì— ì—¬ëŸ¬ ë²ˆ, ë•€ì´ ë‚  ì •ë„ë¡œ ëª¸ì„ ì›€ì§ì´ëŠ” í™œë™ì„ í•œë‹¤."},
    {id:4,cat:"ìš´ë™Â·ê±´ê°• ğŸƒâ€â™‚ï¸",text:"ì±…ìƒì— ì•‰ì•„ ìˆì„ ë•Œ ì˜¬ë°”ë¥¸ ìì„¸ë¥¼ ìœ ì§€í•˜ë ¤ê³  í•œë‹¤."},
    {id:5,cat:"ìš´ë™Â·ê±´ê°• ğŸƒâ€â™‚ï¸",text:"ëˆˆì´ í”¼ë¡œí•˜ì§€ ì•Šë„ë¡ ìŠ¤ë§ˆíŠ¸í°ì´ë‚˜ ì±…ì„ ë„ˆë¬´ ê°€ê¹Œì´ ë³´ì§€ ì•Šìœ¼ë ¤ê³  í•œë‹¤."},

    {id:6,cat:"ìœ„ìƒÂ·ëª¸ ê´€ë¦¬ ğŸ§¼",text:"ëª¸ì„ ê·œì¹™ì ìœ¼ë¡œ ì”»ê³ , ì†ì˜·Â·ì–‘ë§ì„ ë§¤ì¼ ê°ˆì•„ì…ëŠ”ë‹¤."},
    {id:7,cat:"ìœ„ìƒÂ·ëª¸ ê´€ë¦¬ ğŸ§¼",text:"ë•€ì„ ë§ì´ í˜ë ¸ì„ ë•Œ, ì˜·ì„ ê°ˆì•„ì…ê±°ë‚˜ ìƒ¤ì›Œë¥¼ í•œë‹¤."},
    {id:8,cat:"ìœ„ìƒÂ·ëª¸ ê´€ë¦¬ ğŸ§¼",text:"ì›”ê²½Â·ëª½ì •Â·ì—¬ë“œë¦„ ë“± ëª¸ì˜ ë³€í™”ê°€ ìˆì„ ë•Œ, ì²­ê²°ì„ ìœ ì§€í•˜ë ¤ê³  í•œë‹¤."},

    {id:9,cat:"ì •ì„œÂ·ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ ğŸ’­",text:"í™”ê°€ ë‚˜ê±°ë‚˜ ì†ìƒí•  ë•Œ, ë‚˜ë¥¼ ì§„ì •ì‹œí‚¤ëŠ” ë°©ë²•(ì‰¼, ê¹Šì€ ìˆ¨, ì¢‹ì•„í•˜ëŠ” í™œë™ ë“±)ì„ ë– ì˜¬ë ¤ ì‚¬ìš©í•´ ë³¸ë‹¤."},
    {id:10,cat:"ì •ì„œÂ·ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ ğŸ’­",text:"í˜¼ì í•´ê²°í•˜ê¸° ì–´ë ¤ìš´ ê³ ë¯¼ì´ ìˆì„ ë•Œ, ë¯¿ì„ ìˆ˜ ìˆëŠ” ì–´ë¥¸ì—ê²Œ ë„ì›€ì„ ìš”ì²­í•˜ë ¤ê³  í•œë‹¤."},

    {id:11,cat:"ë¯¸ë””ì–´ ì‚¬ìš© ğŸ“±",text:"ìŠ¤ë§ˆíŠ¸í°Â·ê²Œì„Â·ì˜ìƒ ì‹œì²­ ì‹œê°„ì„ ìŠ¤ìŠ¤ë¡œ ì •í•˜ê³  ì§€í‚¤ë ¤ê³  í•œë‹¤."},
    {id:12,cat:"ë¯¸ë””ì–´ ì‚¬ìš© ğŸ“±",text:"ì ìê¸° ì „ì—ëŠ” ìŠ¤ë§ˆíŠ¸í°Â·íƒœë¸”ë¦¿ì„ ì˜¤ë˜ ë³´ì§€ ì•Šìœ¼ë ¤ê³  í•œë‹¤."},

    {id:13,cat:"ì„±ì  ë°œë‹¬ ê´€ë ¨ ğŸ”",text:"ëª¸ì˜ ë³€í™”ë¥¼ ë†€ë¦¼ì´ ì•„ë‹Œ ìì—°ìŠ¤ëŸ¬ìš´ ê³¼ì •ìœ¼ë¡œ ì´í•´í•˜ë ¤ê³  í•œë‹¤."},
    {id:14,cat:"ì„±ì  ë°œë‹¬ ê´€ë ¨ ğŸ”",text:"ìœ í•´í•œ ì˜ìƒì´ë‚˜ ìŒë€ë¬¼, ì§€ë‚˜ì¹˜ê²Œ í­ë ¥ì ì¸ ì˜ìƒì„ ë³´ì§€ ì•Šìœ¼ë ¤ê³  í•œë‹¤."}
  ];

  const step1Checked = new Set();
  let quizIndex = 0;
  const quizAnswers = new Array(quizData.length).fill(null);
  const habitAnswers = {};

  function qs(id){return document.getElementById(id);}

  function updateStepper(){
    qs("stepProgress").style.width = ((currentStep-1)/(totalSteps-1))*100 + "%";
    document.querySelectorAll(".screen").forEach(sec=>{
      sec.classList.toggle("active", sec.id === "step"+currentStep);
    });
    document.querySelectorAll(".step-dot").forEach(dot=>{
      const s = parseInt(dot.dataset.step,10);
      dot.classList.toggle("active", s===currentStep);
    });

    const hint = qs("stepHint");
    if(currentStep===1) hint.textContent="1ë‹¨ê³„: ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ í†µí•´ ë‚˜ì˜ ë³€í™”ë¥¼ ì‚´í´ë³´ëŠ” ì¤‘ì…ë‹ˆë‹¤.";
    else if(currentStep===2) hint.textContent="2ë‹¨ê³„: ìƒí™©Â·ê°œë…Â·í˜¼í•©í˜• í€´ì¦ˆë¥¼ í’€ë©° ë°œë‹¬ì„ ê¹Šì´ ì´í•´í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤.";
    else if(currentStep===3) hint.textContent="3ë‹¨ê³„: ìˆ˜ë©´Â·ìš´ë™Â·ìœ„ìƒÂ·ë¯¸ë””ì–´ ì‚¬ìš© ë“± ìƒí™œìŠµê´€ì„ ì ê²€í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤.";
    else hint.textContent="4ë‹¨ê³„: ì§€ê¸ˆê¹Œì§€ì˜ ë‹µì„ ë°”íƒ•ìœ¼ë¡œ ë‚˜ì˜ ë°œë‹¬ ì¹´ë“œë¥¼ í™•ì¸í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤.";

    qs("btnPrev").disabled = currentStep===1;
    qs("btnNext").textContent = currentStep===4 ? "ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸° ğŸ”" : "ë‹¤ìŒ ë‹¨ê³„ë¡œ â–¶";
  }

  function renderStep1(){
    const grid = qs("domainGrid");
    grid.innerHTML="";
    const group = {physical:[],cognitive:[],emotional:[],social:[]};
    step1Questions.forEach(q=>group[q.domain].push(q));

    Object.keys(group).forEach(key=>{
      const card = document.createElement("div");
      card.className="domain-card";
      const h = document.createElement("div");
      h.className="domain-header";
      const t = document.createElement("div");
      t.className="domain-title";
      t.textContent = domainsMeta[key].emoji+" "+domainsMeta[key].label;
      const chip = document.createElement("div");
      chip.className="domain-chip";
      const cnt = step1Questions.filter(q=>q.domain===key && step1Checked.has(q.id)).length;
      chip.textContent="ì²´í¬ "+cnt+"/4";
      h.appendChild(t);h.appendChild(chip);
      card.appendChild(h);

      group[key].forEach(q=>{
        const row=document.createElement("label");
        row.className="question-row";
        const inp=document.createElement("input");
        inp.type="checkbox";
        inp.checked = step1Checked.has(q.id);
        inp.addEventListener("change",()=>{
          if(inp.checked) step1Checked.add(q.id);
          else step1Checked.delete(q.id);
          renderStep1();
        });
        const text=document.createElement("div");
        text.textContent=q.text;
        row.appendChild(inp);row.appendChild(text);
        card.appendChild(row);
      });

      grid.appendChild(card);
    });
  }

  function renderQuiz(){
    const q = quizData[quizIndex];
    const card = qs("quizCard");
    card.innerHTML="";

    const top=document.createElement("div");
    top.className="quiz-top";
    const left=document.createElement("div");
    left.textContent="ë¬¸ì œ "+(quizIndex+1)+" / "+quizData.length;
    const tag=document.createElement("div");
    tag.className="quiz-tag";tag.textContent=q.tag;
    top.appendChild(left);top.appendChild(tag);

    const qDiv=document.createElement("div");
    qDiv.className="quiz-q";qDiv.textContent=q.text;

    const optWrap=document.createElement("div");
    optWrap.className="quiz-options";
    ["A","B","C"].forEach((lab,i)=>{
      const div=document.createElement("div");
      div.className="option-card";
      if(quizAnswers[quizIndex]===i) div.classList.add("selected");
      const s1=document.createElement("span");
      s1.className="label";s1.textContent=lab;
      const s2=document.createElement("span");
      s2.textContent=q.options[i];
      div.appendChild(s1);div.appendChild(s2);
      div.addEventListener("click",()=>{
        quizAnswers[quizIndex]=i;
        renderQuiz();
      });
      optWrap.appendChild(div);
    });

    card.appendChild(top);card.appendChild(qDiv);card.appendChild(optWrap);

    let dots="";
    for(let i=0;i<quizData.length;i++){
      const done = quizAnswers[i]!==null;
      if(i===quizIndex) dots += done?"â— ":"â—‰ ";
      else dots += done?"â— ":"â—‹ ";
    }
    qs("quizDots").textContent=dots.trim();

    // í€´ì¦ˆ ë‚´ ì´ì „/ë‹¤ìŒ ë²„íŠ¼ ìƒíƒœ
    qs("btnQuizPrev").disabled = quizIndex===0;
    qs("btnQuizNext").textContent = quizIndex===quizData.length-1 ? "ë§ˆì§€ë§‰ ë¬¸ì œì…ë‹ˆë‹¤ â–¶" : "ë‹¤ìŒ ë¬¸ì œ â–¶";
  }

  function renderHabits(){
    const grid = qs("habitGrid");
    grid.innerHTML="";
    const grouped={};
    habitItems.forEach(h=>{
      if(!grouped[h.cat]) grouped[h.cat]=[];
      grouped[h.cat].push(h);
    });

    Object.keys(grouped).forEach(cat=>{
      const box=document.createElement("div");
      box.className="habit-cat";
      const title=document.createElement("div");
      title.className="habit-title";
      title.textContent=cat;
      box.appendChild(title);

      grouped[cat].forEach(item=>{
        const wrap=document.createElement("div");
        wrap.className="habit-item";
        const t=document.createElement("div");
        t.className="habit-text";
        t.textContent=item.text;
        const scale=document.createElement("div");
        scale.className="habit-scale";
        const opts=[
          {v:3,label:"í•­ìƒ"},
          {v:2,label:"ë³´í†µ"},
          {v:1,label:"ê±°ì˜ ì•„ë‹ˆë‹¤"}
        ];
        opts.forEach(o=>{
          const btn=document.createElement("button");
          btn.type="button";
          btn.className="habit-btn";
          if(habitAnswers[item.id]===o.v) btn.classList.add("selected");
          btn.textContent=o.label;
          btn.addEventListener("click",()=>{
            habitAnswers[item.id]=o.v;
            renderHabits();
            updateHabitPreview();
          });
          scale.appendChild(btn);
        });
        wrap.appendChild(t);wrap.appendChild(scale);
        box.appendChild(wrap);
      });

      grid.appendChild(box);
    });
    updateHabitPreview();
  }

  function updateHabitPreview(){
    let score=0,answered=0;
    habitItems.forEach(h=>{
      const v = habitAnswers[h.id] || 0;
      if(v>0) answered++;
      if(v===2) score+=1;
      else if(v===3) score+=2;
    });
    qs("habitPreview").textContent=score;
    const lv = qs("habitLevel");
    if(!answered) lv.textContent="ì•„ì§ ì„ íƒí•œ ë¬¸í•­ì´ ê±°ì˜ ì—†ì–´ìš”.";
    else if(score>=23) lv.textContent="ìƒí™œìŠµê´€ì´ ì „ë°˜ì ìœ¼ë¡œ ë§¤ìš° ê±´ê°•í•œ í¸ì´ì—ìš”!";
    else if(score>=15) lv.textContent="ìƒí™œìŠµê´€ì´ ë³´í†µ ì´ìƒì´ì—ìš”. í•œë‘ ê°€ì§€ë¥¼ ë³´ì™„í•˜ë©´ ë” ì¢‹ì•„ì§ˆ ìˆ˜ ìˆì–´ìš”.";
    else lv.textContent="ìƒí™œìŠµê´€ì„ ì¡°ê¸ˆ ë” ì •ë¦¬í•´ ë³´ë©´ ì¢‹ê² ì–´ìš”.";
  }

  function getDomainScores(){
    const scores={physical:0,cognitive:0,emotional:0,social:0};
    step1Questions.forEach(q=>{
      if(step1Checked.has(q.id)) scores[q.domain]++;
    });
    return scores;
  }

  function getDomainText(key,score){
    const label = domainsMeta[key].label;
    if(key==="physical"){
      if(score<=1) return "â— "+label+"\nëª¸ì˜ ë³€í™”ë¥¼ ì•„ì§ ì˜ ëŠë¼ì§€ ëª»í•  ìˆ˜ë„ ìˆì–´ìš”.\nì•ìœ¼ë¡œ í‚¤ì™€ ì²´ë ¥, í”¼ê³¤í•¨ ë“±ì„ ì¡°ê¸ˆ ë” ê´€ì°°í•´ ë³´ë©´ ì¢‹ì•„ìš”.";
      if(score<=3) return "â— "+label+"\nëª¸ì´ ìë¼ê³  ìˆë‹¤ëŠ” ê²ƒì„ ì˜ ëŠë¼ê³  ìˆì–´ìš”.\nìš´ë™Â·ìˆ˜ë©´Â·ì‹ìŠµê´€ì„ ì˜ ìœ ì§€í•˜ë©´ ë”ìš± ê±´ê°•í•˜ê²Œ ì„±ì¥í•  ìˆ˜ ìˆì–´ìš”.";
      return "â— "+label+"\nì‹ ì²´ê°€ ìë¼ëŠ” ëª¨ìŠµì„ ì˜ ì´í•´í•˜ê³  ìˆê³ , ìŠ¤ìŠ¤ë¡œ ê±´ê°•ì„ ì±™ê¸°ë ¤ëŠ” íƒœë„ê°€ ë‹ë³´ì…ë‹ˆë‹¤.";
    }
    if(key==="cognitive"){
      if(score<=1) return "â— "+label+"\nìƒê°ì´ë‚˜ í•™ìŠµì—ì„œì˜ ë³€í™”ë¥¼ ì•„ì§ ë§ì´ ëŠë¼ì§€ ëª»í•  ìˆ˜ë„ ìˆì–´ìš”.\nê³„íš ì„¸ìš°ê¸°ì™€ ì—¬ëŸ¬ í•´ê²° ë°©ë²•ì„ ì—°ìŠµí•´ ë³´ë©´ ì¢‹ì•„ìš”.";
      if(score<=3) return "â— "+label+"\në¬¸ì œë¥¼ ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ í•´ê²°í•˜ê³ , ìŠ¤ìŠ¤ë¡œ ìƒê°í•˜ë ¤ëŠ” í˜ì´ ìë¼ê³  ìˆì–´ìš”.";
      return "â— "+label+"\në…¼ë¦¬ì ìœ¼ë¡œ ìƒê°í•˜ê³  ê³„íšì„ ì„¸ìš°ëŠ” ëŠ¥ë ¥ì´ ì˜ ë°œë‹¬í•˜ê³  ìˆì–´ìš”. ìŠ¤ìŠ¤ë¡œ ê³µë¶€ ë°©ë²•ì„ ì„ íƒí•˜ëŠ” ë°ë„ ë„ì›€ì´ ë©ë‹ˆë‹¤.";
    }
    if(key==="emotional"){
      if(score<=1) return "â— "+label+"\nì—¬ëŸ¬ ê°ì •ì„ ìŠ¤ìŠ¤ë¡œ ì´í•´í•˜ê³  í‘œí˜„í•˜ëŠ” ì—°ìŠµì´ ì¡°ê¸ˆ ë” í•„ìš”í•´ìš”.\nê°ì •ì„ ì¸ì •í•˜ê³  ì•ˆì „í•˜ê²Œ í‘œí˜„í•˜ëŠ” ë°©ë²•ì„ ìµí˜€ ë³´ë©´ ì¢‹ìŠµë‹ˆë‹¤.";
      if(score<=3) return "â— "+label+"\nê°ì •ì„ ë‹¤ì–‘í•˜ê²Œ ëŠë¼ê³ , ì°¨ë¶„í•˜ê²Œ ì¡°ì ˆí•˜ë ¤ëŠ” ë…¸ë ¥ì´ ë³´ì…ë‹ˆë‹¤.";
      return "â— "+label+"\nê°ì •ì„ ì˜ ì¸ì‹í•˜ê³ , ë§ê³¼ í–‰ë™ìœ¼ë¡œ ì¡°ì ˆí•˜ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì£¼ë³€ ì‚¬ëŒì˜ ê°ì •ë„ ì˜ ì‚´í•„ ìˆ˜ ìˆì–´ìš”.";
    }
    if(key==="social"){
      if(score<=1) return "â— "+label+"\nì¹œêµ¬ì™€ì˜ ê´€ê³„ì—ì„œ ë” ì ê·¹ì ìœ¼ë¡œ ëŒ€í™”í•˜ê³ , ë°°ë ¤ë¥¼ í‘œí˜„í•˜ëŠ” ì—°ìŠµì„ í•´ ë³´ë©´ ì¢‹ì•„ìš”.";
      if(score<=3) return "â— "+label+"\në‹¤ë¥¸ ì‚¬ëŒì˜ ê¸°ë¶„ì„ ìƒê°í•˜ê³ , ëŒ€í™”ë¥¼ í†µí•´ ê´€ê³„ë¥¼ ì§€í‚¤ë ¤ëŠ” ëª¨ìŠµì´ ë³´ì…ë‹ˆë‹¤.";
      return "â— "+label+"\nì¹œêµ¬ì™€ í˜‘ë ¥í•˜ê³  ê°ˆë“±ì„ í•´ê²°í•˜ëŠ” ì‚¬íšŒì„±ì´ ì˜ ë°œë‹¬í•´ ìˆì–´ìš”. ì£¼ë³€ ì¹œêµ¬ë“¤ì—ê²Œë„ ì¢‹ì€ ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆì–´ìš”.";
    }
    return "";
  }

  function getUnderstandingScore(){
    let s=0;
    quizData.forEach((q,i)=>{
      if(quizAnswers[i]===q.correct) s++;
    });
    return s;
  }

  function getUnderstandingText(score){
    if(score>=7) return "â— ë°œë‹¬ ì´í•´ ì ìˆ˜: ë§¤ìš° ì¢‹ìŒ ("+score+" / "+quizData.length+"ì )\nì•„ë™ê¸°ì˜ ë°œë‹¬ ê°œë…ê³¼ ì‹¤ì œ ìƒí™©ì„ ê¹Šì´ ìˆê²Œ ì´í•´í•˜ê³  ìˆë„¤ìš”.";
    if(score>=4) return "â— ë°œë‹¬ ì´í•´ ì ìˆ˜: ë³´í†µ ("+score+" / "+quizData.length+"ì )\nì „ì²´ì ìœ¼ë¡œëŠ” ì˜ ì´í•´í•˜ê³  ìˆì§€ë§Œ, ëª‡ ê°€ì§€ ê°œë…ì€ ë‹¤ì‹œ í•œ ë²ˆ ì •ë¦¬í•´ ë³´ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.";
    return "â— ë°œë‹¬ ì´í•´ ì ìˆ˜: ë³´ì™„ í•„ìš” ("+score+" / "+quizData.length+"ì )\në°œë‹¬ì˜ ê°œì¸ì°¨, ê°ì • ì¡°ì ˆ, ë„ì›€ ìš”ì²­ ë“±ì— ëŒ€í•´ ë‹¤ì‹œ êµê³¼ì„œë¥¼ ì½ê³  ì„ ìƒë‹˜ê³¼ ì´ì•¼ê¸°í•´ ë³´ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.";
  }

  function getHabitScore(){
    let score=0;
    habitItems.forEach(h=>{
      const v = habitAnswers[h.id] || 0;
      if(v===2) score+=1;
      else if(v===3) score+=2;
    });
    return score;
  }

  function getHabitText(score){
    if(score>=23) return "â— ìƒí™œìŠµê´€ ì ìˆ˜: ë§¤ìš° ê±´ê°• ("+score+" / 28ì )\nìˆ˜ë©´Â·ìš´ë™Â·ìœ„ìƒÂ·ë¯¸ë””ì–´ ì‚¬ìš© ë“± ìƒí™œìŠµê´€ì´ ì „ë°˜ì ìœ¼ë¡œ ë§¤ìš° ê±´ê°•í•œ í¸ì´ì—ìš”.\nì´ëŸ° ìŠµê´€ì€ ë°œë‹¬ì— í° ë„ì›€ì´ ë©ë‹ˆë‹¤.";
    if(score>=15) return "â— ìƒí™œìŠµê´€ ì ìˆ˜: ë³´í†µ ("+score+" / 28ì )\nëŒ€ë¶€ë¶„ì˜ ìƒí™œìŠµê´€ì€ ê´œì°®ì§€ë§Œ, í•œë‘ ê°€ì§€ ì˜ì—­ì„ ì •í•´ ì¡°ê¸ˆ ë” ì‹ ê²½ ì“°ë©´ ë” ê±´ê°•í•˜ê²Œ ìë„ ìˆ˜ ìˆì–´ìš”.";
    return "â— ìƒí™œìŠµê´€ ì ìˆ˜: ë³´ì™„ í•„ìš” ("+score+" / 28ì )\nìƒí™œìŠµê´€ì„ í•œëˆˆì— ì‚´í´ë³´ê³ , ìˆ˜ë©´Â·ìš´ë™Â·ìœ„ìƒÂ·ë¯¸ë””ì–´ ì¤‘ í•˜ë‚˜ë¥¼ ê³¨ë¼ ì‘ì€ ëª©í‘œë¶€í„° ì‹¤ì²œí•´ ë³´ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.";
  }

  function buildStrengthsAndImprovements(domainScores,underScore,habitScore){
    const strengths=[],improves=[];
    if(domainScores.physical>=3) strengths.push("ëª¸ì˜ ë³€í™”ë¥¼ ì˜ ëŠë¼ê³ , ê±´ê°•ì„ ìŠ¤ìŠ¤ë¡œ ì§€í‚¤ë ¤ëŠ” íƒœë„ê°€ ì¢‹ì•„ìš”.");
    if(domainScores.cognitive>=3) strengths.push("ë¬¸ì œë¥¼ ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ í•´ê²°í•˜ê³ , ê³„íšì„ ì„¸ìš°ë©° ìŠ¤ìŠ¤ë¡œ ìƒê°í•˜ëŠ” í˜ì´ ì˜ ìë¼ê³  ìˆì–´ìš”.");
    if(domainScores.emotional>=3) strengths.push("ê°ì •ì„ ì•Œì•„ì°¨ë¦¬ê³  ì¡°ì ˆí•˜ë ¤ëŠ” ë…¸ë ¥ì´ ë‹ë³´ì´ë©°, ì£¼ë³€ ì‚¬ëŒì˜ ë§ˆìŒë„ ì˜ ì‚´í”¼ë ¤ê³  í•©ë‹ˆë‹¤.");
    if(domainScores.social>=3) strengths.push("ì¹œêµ¬ì™€ í˜‘ë ¥í•˜ê³ , ê°ˆë“±ì´ ìˆì„ ë•Œ ëŒ€í™”ë¥¼ í†µí•´ í•´ê²°í•˜ë ¤ëŠ” ì‚¬íšŒì„±ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.");
    if(underScore>=6) strengths.push("ë°œë‹¬ì— ëŒ€í•œ ê°œë…ì„ ì˜ ì´í•´í•˜ê³ , ì‹¤ì œ ìƒí™©ì—ì„œë„ ë°”ë¥´ê²Œ ì ìš©í•  ìˆ˜ ìˆëŠ” í˜ì´ ìˆìŠµë‹ˆë‹¤.");
    if(habitScore>=23) strengths.push("ê·œì¹™ì ì¸ ìƒí™œìŠµê´€ì„ ì˜ ìœ ì§€í•˜ê³  ìˆì–´, ì•ìœ¼ë¡œì˜ ì„±ì¥ì— í° ë„ì›€ì´ ë  ê²ƒì…ë‹ˆë‹¤.");

    if(domainScores.physical<=1) improves.push("ìš´ë™Â·ìˆ˜ë©´Â·ì‹ìŠµê´€ì„ ì¡°ê¸ˆ ë” ì±™ê²¨ ë³´ë©°, ë‚´ ëª¸ì˜ ë³€í™”ë¥¼ ê¸ì •ì ìœ¼ë¡œ ë°”ë¼ë³´ëŠ” ì—°ìŠµì„ í•´ ë³´ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.");
    if(domainScores.cognitive<=1) improves.push("í•˜ë£¨ë‚˜ ì¼ì£¼ì¼ ê³„íšì„ ì„¸ìš°ê³ , ì‹¤í–‰ í›„ ë‹¤ì‹œ ëŒì•„ë³´ëŠ” ìŠµê´€ì„ ì¡°ê¸ˆì”© ê¸¸ëŸ¬ ë³´ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.");
    if(domainScores.emotional<=1) improves.push("ê°ì •ì„ ì°¸ê¸°ë§Œ í•˜ê¸°ë³´ë‹¤ëŠ”, ì•ˆì „í•œ ë°©ë²•ìœ¼ë¡œ í‘œí˜„í•˜ê³  ë„ì›€ì„ ìš”ì²­í•˜ëŠ” ì—°ìŠµì´ í•„ìš”í•©ë‹ˆë‹¤.");
    if(domainScores.social<=1) improves.push("ì¹œêµ¬ì—ê²Œ ë¨¼ì € ë§ì„ ê±¸ì–´ ë³´ê±°ë‚˜, ê°ˆë“±ì´ ìƒê²¼ì„ ë•Œ ëŒ€í™”ë¥¼ ì‹œë„í•´ ë³´ëŠ” ê²½í—˜ì„ ëŠ˜ë ¤ ë³´ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.");
    if(underScore<=3) improves.push("ë°œë‹¬ì˜ ê°œì¸ì°¨Â·ê°ì • ì¡°ì ˆÂ·ë„ì›€ ìš”ì²­ì— ëŒ€í•œ ê°œë…ì„ ë‹¤ì‹œ ì½ê³ , ì‹¤ì œ ìƒí™©ì— ì–´ë–»ê²Œ ì ìš©í• ì§€ ìƒê°í•´ ë³´ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.");
    if(habitScore<=22) improves.push("ìˆ˜ë©´Â·ë¯¸ë””ì–´ ì‚¬ìš©Â·ê°ì • ê´€ë¦¬ ì¤‘ í•œ ê°€ì§€ë¥¼ ì„ íƒí•´, ì¼ì£¼ì¼ ë™ì•ˆë§Œì´ë¼ë„ ì‘ì€ ë³€í™”ë¥¼ ì‹œë„í•´ ë³´ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.");

    while(strengths.length<3){
      strengths.push("ìŠ¤ìŠ¤ë¡œë¥¼ ëŒì•„ë³´ê³ ì í•˜ëŠ” íƒœë„ ìì²´ê°€ ì´ë¯¸ í° ê°•ì ì´ì—ìš”.");
    }
    while(improves.length<2){
      improves.push("ì§€ê¸ˆì˜ ë‚˜ë¥¼ ì¸ì •í•˜ë©´ì„œ, ì¡°ê¸ˆì”© ë‚˜ì•„ì§€ê³  ì‹¶ì€ ë¶€ë¶„ì„ ì •í•´ ë³´ëŠ” ê²ƒì´ ë„ì›€ì´ ë©ë‹ˆë‹¤.");
    }
    return {strengths:strengths.slice(0,3),improves:improves.slice(0,2)};
  }

  function renderResult(){
    const scores = getDomainScores();
    const underScore = getUnderstandingScore();
    const habitScore = getHabitScore();

    const bars = qs("domainBars");
    bars.innerHTML="";
    Object.keys(scores).forEach(k=>{
      const row=document.createElement("div");
      row.className="domain-bar-row";
      const label=document.createElement("span");
      label.textContent = domainsMeta[k].emoji+" "+domainsMeta[k].label;
      const dots=document.createElement("span");
      dots.className="dots";
      let d="";
      for(let i=0;i<4;i++) d+= i<scores[k] ? "â—" : "â—‹";
      dots.textContent=d;
      row.appendChild(label);row.appendChild(dots);
      bars.appendChild(row);
    });

    const domText = Object.keys(scores).map(k=>getDomainText(k,scores[k])).join("\n\n");
    qs("domainAnalysis").textContent = domText;
    qs("understandingAnalysis").textContent = getUnderstandingText(underScore);
    qs("habitAnalysis").textContent = getHabitText(habitScore);

    const si = buildStrengthsAndImprovements(scores,underScore,habitScore);
    qs("strengthList").textContent = si.strengths.map(s=>"Â· "+s).join("\n");
    qs("improveList").textContent = si.improves.map(s=>"Â· "+s).join("\n");
  }

  function goNext(){
    if(currentStep===1){
      if(step1Checked.size===0){
        if(!confirm("ì•„ì§ ì²´í¬í•œ ë¬¸í•­ì´ ì—†ì–´ìš”. ê·¸ë˜ë„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°ˆê¹Œìš”?")) return;
      }
      currentStep=2;
    }else if(currentStep===2){
      if(quizAnswers.some(v=>v===null)){
        if(!confirm("í’€ì§€ ì•Šì€ ë¬¸ì œê°€ ìˆì–´ìš”. ê·¸ë˜ë„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°ˆê¹Œìš”?")) return;
      }
      currentStep=3;
    }else if(currentStep===3){
      currentStep=4;
      renderResult();
    }else{
      currentStep=1;
    }
    updateStepper();
  }

  function goPrev(){
    if(currentStep>1){
      currentStep--;
      updateStepper();
    }
  }

  function init(){
    renderStep1();
    renderQuiz();
    renderHabits();
    updateStepper();

    qs("btnNext").addEventListener("click",goNext);
    qs("btnPrev").addEventListener("click",goPrev);

    qs("btnQuizPrev").addEventListener("click",function(){
      if(quizIndex>0){
        quizIndex--;
        renderQuiz();
      }
    });
    qs("btnQuizNext").addEventListener("click",function(){
      if(quizIndex<quizData.length-1){
        quizIndex++;
        renderQuiz();
      }
    });

    document.addEventListener("keydown",function(e){
      if(currentStep!==2) return;
      if(e.key==="ArrowRight" && quizIndex<quizData.length-1){
        quizIndex++;renderQuiz();
      }else if(e.key==="ArrowLeft" && quizIndex>0){
        quizIndex--;renderQuiz();
      }
    });
  }

  document.addEventListener("DOMContentLoaded",init);
})();
</script>
</body>
</html>
