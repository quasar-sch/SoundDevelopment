<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë‚˜ì˜ ë°œë‹¬ ì¢…í•© ì‹œë®¬ë ˆì´í„°</title>
  <style>
    :root {
      font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      color:#222;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:flex-start;
      background:radial-gradient(circle at top left,#fdf3e7,#f0f6ff);
    }
    .app{
      width:100%;
      max-width:980px;
      margin:24px;
      background:#ffffffee;
      border-radius:20px;
      box-shadow:0 12px 32px rgba(0,0,0,0.08);
      padding:22px 20px 26px;
    }
    header{
      display:flex;
      gap:16px;
      align-items:center;
      margin-bottom:14px;
    }
    .hero{
      width:68px;height:68px;border-radius:50%;
      background:conic-gradient(from 180deg,#4b8cf5,#81c784,#ffb74d,#ba68c8,#4b8cf5);
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 6px 16px rgba(0,0,0,0.15);
      flex-shrink:0;
    }
    .hero span{
      width:54px;height:54px;border-radius:50%;
      background:#fff;display:flex;align-items:center;justify-content:center;
      font-size:40px;
    }
    .title-block h1{margin:0;font-size:24px;}
    .title-block .sub{margin-top:4px;font-size:13px;color:#555;}

    .stepper{margin:10px 0 16px;}
    .stepper-bar{position:relative;width:100%;height:6px;border-radius:999px;background:#e0e6f2;overflow:hidden;}
    .stepper-progress{position:absolute;top:0;left:0;height:100%;background:linear-gradient(90deg,#4b8cf5,#81c784);width:0%;transition:width .2s;}
    .stepper-labels{display:flex;justify-content:space-between;margin-top:8px;font-size:11px;color:#666;}
    .stepper-label{display:flex;align-items:center;gap:4px;}
    .step-dot{
      width:16px;height:16px;border-radius:50%;
      border:2px solid #cbd4ea;
      display:flex;align-items:center;justify-content:center;
      font-size:11px;background:#fff;color:#777;
    }
    .step-dot.active{border-color:#4b8cf5;background:#4b8cf5;color:#fff;}

    .screen{display:none;margin-top:4px;}
    .screen.active{display:block;}

    .guide{display:flex;align-items:flex-start;gap:8px;margin-bottom:10px;font-size:13px;color:#444;}
    .guide-icon{font-size:20px;}
    .guide-text{background:#f4f7ff;border-radius:12px;padding:8px 10px;border:1px solid #dde4fb;}

    h2{margin:4px 0 6px;font-size:18px;}
    .desc{font-size:13px;color:#555;margin-bottom:8px;}

    .domain-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:12px;
      margin-top:6px;
    }
    .domain-card{
      background:#fff;border-radius:16px;
      border:1px solid #e2e6f4;
      padding:10px 11px 12px;
      box-shadow:0 4px 10px rgba(0,0,0,0.04);
      font-size:13px;
    }
    .domain-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;}
    .domain-title{display:flex;align-items:center;gap:6px;font-size:14px;font-weight:600;}
    .domain-chip{font-size:11px;padding:2px 7px;border-radius:999px;background:#edf2ff;color:#3c4a8a;}
    .question-row{display:flex;gap:6px;align-items:flex-start;padding:3px 0;}
    .question-row input{margin-top:3px;}

    .quiz-card{
      background:#fff;border-radius:18px;
      border:1px solid #e1e3f0;
      padding:14px 14px 12px;
      box-shadow:0 6px 16px rgba(0,0,0,0.05);
      margin-top:4px;font-size:13px;
    }
    .quiz-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;font-size:12px;color:#666;}
    .quiz-tag{font-size:11px;padding:2px 8px;border-radius:999px;background:#fdf0ff;color:#8a3aa8;}
    .quiz-q{white-space:pre-line;font-size:14px;margin-bottom:10px;}
    .quiz-options{display:flex;flex-direction:column;gap:6px;}
    .option-card{
      border-radius:999px;border:1px solid #dde1f0;
      padding:6px 10px;
      cursor:pointer;
      display:flex;gap:6px;align-items:center;
      background:#fafbff;
      transition:border-color .15s,background .15s,transform .08s;
      font-size:13px;
    }
    .option-card span.label{font-weight:600;color:#555;}
    .option-card:hover{border-color:#b8c3f5;transform:translateY(-1px);}
    .option-card.selected{border-color:#4b8cf5;background:#eaf1ff;}
    .quiz-dots{text-align:center;margin-top:8px;font-size:11px;color:#666;}

    .habit-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:10px;margin-top:6px;
    }
    .habit-cat{
      background:#fff;border-radius:16px;
      border:1px solid #e3e7f3;
      padding:8px 10px 10px;
      box-shadow:0 4px 10px rgba(0,0,0,0.04);
      font-size:13px;
    }
    .habit-title{font-weight:600;margin-bottom:4px;}
    .habit-item{margin-top:6px;}
    .habit-text{margin-bottom:4px;}
    .habit-scale{display:flex;gap:4px;flex-wrap:wrap;}
    .habit-btn{
      border-radius:999px;border:1px solid #d4d9ea;
      padding:3px 8px;font-size:12px;
      background:#f7f8fd;cursor:pointer;
      transition:background .15s,border-color .15s;
    }
    .habit-btn.selected{background:#4b8cf5;border-color:#4b8cf5;color:#fff;}
    .habit-summary{
      margin-top:10px;background:#f5f8ff;border-radius:12px;
      padding:8px 10px;border:1px solid #dce4ff;
      font-size:12px;display:flex;justify-content:space-between;flex-wrap:wrap;gap:6px;
    }

    .result-card{
      margin-top:6px;border-radius:20px;
      overflow:hidden;box-shadow:0 10px 28px rgba(0,0,0,0.08);
      background:#fff;
    }
    .result-strip{height:42px;background:linear-gradient(90deg,#4b8cf5,#81c784,#ffb74d,#ba68c8);}
    .result-body{padding:14px 16px 16px;}
    .result-header{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:8px;}
    .result-header h3{margin:0;font-size:18px;}
    .result-sub{font-size:11px;color:#666;}
    .name-row{margin-bottom:8px;font-size:13px;display:flex;align-items:center;gap:6px;}
    .name-row input{border-radius:999px;border:1px solid #d5dae9;padding:3px 8px;font-size:12px;min-width:120px;}

    .domain-bars{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
      gap:8px;margin-bottom:10px;font-size:12px;
    }
    .domain-bar-row{display:flex;align-items:center;gap:6px;}
    .dots{letter-spacing:1px;font-size:13px;}

    .analysis{
      margin-top:6px;border-radius:12px;
      padding:8px 10px;font-size:12px;
      line-height:1.6;white-space:pre-line;
      background:#f8faff;border-left:4px solid #4b8cf5;
    }
    .analysis.secondary{background:#f7fff8;border-left-color:#81c784;}

    .strengths{
      display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:8px;margin-top:8px;font-size:12px;
    }
    .strength-box{
      border-radius:12px;padding:8px 10px;
      background:#f3fbf5;border:1px solid #cde7d4;
      white-space:pre-line;
    }
    .improve-box{
      border-radius:12px;padding:8px 10px;
      background:#fff7ec;border:1px solid #ffd4a6;
      white-space:pre-line;
    }

    .prompt-area{margin-top:10px;font-size:12px;}
    .prompt-area p{margin:4px 0 6px;color:#555;}
    textarea{
      width:100%;min-height:80px;border-radius:10px;
      border:1px solid #d3daea;padding:8px;font-size:12px;
      resize:vertical;font-family:ui-monospace,Menlo,Consolas,monospace;
    }
    #copyStatus{font-size:11px;color:#555;margin-top:4px;}

    .footer{
      margin-top:16px;display:flex;justify-content:space-between;align-items:center;
      gap:8px;flex-wrap:wrap;font-size:12px;color:#555;
    }
    .footer-left{max-width:60%;}
    .btn-row{display:flex;gap:8px;flex-wrap:wrap;}
    button{
      border-radius:999px;border:none;padding:7px 15px;
      font-size:13px;cursor:pointer;
      background:#4b8cf5;color:#fff;
      box-shadow:0 4px 10px rgba(75,140,245,0.4);
      transition:background .15s,transform .08s,box-shadow .08s;
    }
    button:hover{background:#3a78dd;transform:translateY(-1px);box-shadow:0 6px 14px rgba(75,140,245,0.45);}
    button.secondary{background:#e3e7f2;color:#333;box-shadow:none;}
    button.secondary:hover{background:#d4d9ec;}
    button:disabled{opacity:.5;cursor:not-allowed;box-shadow:none;transform:none;}

    @media (max-width:640px){
      .app{margin:14px;padding:18px 14px 22px;}
      header{align-items:flex-start;}
      .footer-left{max-width:100%;}
    }
  </style>
</head>
<body>
<div class="app">
  <header>
    <div class="hero"><span>ğŸ§’</span></div>
    <div class="title-block">
      <h1>ë‚˜ì˜ ë°œë‹¬ ì¢…í•© ì‹œë®¬ë ˆì´í„°</h1>
      <div class="sub">5í•™ë…„ ì‹¤ê³¼ &lt;ë‚˜ì˜ ë°œë‹¬&gt; ë‹¨ì›ì„ ë°”íƒ•ìœ¼ë¡œ, ë‚˜ì˜ ì„±ì¥ê³¼ ìƒí™œìŠµê´€ì„ ëŒì•„ë³´ëŠ” ìê¸°í‰ê°€ ë„êµ¬ì…ë‹ˆë‹¤.</div>
    </div>
  </header>

  <div class="stepper">
    <div class="stepper-bar"><div id="stepProgress" class="stepper-progress"></div></div>
    <div class="stepper-labels">
      <div class="stepper-label"><div class="step-dot" data-step="1">1</div> ë‚˜ì˜ ë³€í™”</div>
      <div class="stepper-label"><div class="step-dot" data-step="2">2</div> ë°œë‹¬ ì´í•´ í€´ì¦ˆ</div>
      <div class="stepper-label"><div class="step-dot" data-step="3">3</div> ìƒí™œìŠµê´€ ì ê²€</div>
      <div class="stepper-label"><div class="step-dot" data-step="4">4</div> ê²°ê³¼ ì¹´ë“œ</div>
    </div>
  </div>

  <!-- STEP 1 -->
  <section id="step1" class="screen active">
    <div class="guide">
      <div class="guide-icon">ğŸ£</div>
      <div class="guide-text">ì§€ë‚œ 1ë…„ ë™ì•ˆ ë‹¬ë¼ì§„ ë‚˜ì˜ ëª¨ìŠµì„ ë– ì˜¬ë¦¬ë©´ì„œ, í•´ë‹¹ë˜ëŠ” ë¬¸ì¥ì„ ì²´í¬í•´ ë³´ì„¸ìš”.</div>
    </div>
    <h2>1ë‹¨ê³„. ì§€ë‚œ 1ë…„ ë™ì•ˆ, ë‚˜ëŠ” ì–´ë–»ê²Œ ìëì„ê¹Œ?</h2>
    <div class="desc">ì‹ ì²´, ìƒê°, ê°ì •, ì¹œêµ¬ ê´€ê³„ì—ì„œ ëŠë¼ëŠ” ë³€í™”ë¥¼ ê³¨ê³ ë£¨ ì‚´í´ë³´ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤.</div>
    <div id="domainGrid" class="domain-grid"></div>
  </section>

  <!-- STEP 2 -->
  <section id="step2" class="screen">
    <div class="guide">
      <div class="guide-icon">ğŸ§©</div>
      <div class="guide-text">ì—¬ëŸ¬ ìƒí™©ì—ì„œ ì–´ë–¤ ì„ íƒì´ ë‚˜ì™€ ì¹œêµ¬ì—ê²Œ ë„ì›€ì´ ë˜ëŠ”ì§€ ìƒê°í•´ ë³´ì„¸ìš”.</div>
    </div>
    <h2>2ë‹¨ê³„. ì´ëŸ° ìƒí™©ì—ì„œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í• ê¹Œ?</h2>
    <div class="desc">ì•„ë™ê¸°ì˜ ë°œë‹¬ì„ ë°”ë¥´ê²Œ ì´í•´í•˜ê³  ìˆëŠ”ì§€ í™•ì¸í•´ ë³´ëŠ” ì§§ì€ í€´ì¦ˆì…ë‹ˆë‹¤.</div>
    <div id="quizCard" class="quiz-card"></div>
    <div id="quizDots" class="quiz-dots"></div>
  </section>

  <!-- STEP 3 -->
  <section id="step3" class="screen">
    <div class="guide">
      <div class="guide-icon">ğŸŒ±</div>
      <div class="guide-text">ê±´ê°•í•œ ë°œë‹¬ì„ ìœ„í•´ ì§€ê¸ˆì˜ ìƒí™œìŠµê´€ì´ ì–´ë–¤ì§€ ì†”ì§í•˜ê²Œ ì²´í¬í•´ ë³´ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤.</div>
    </div>
    <h2>3ë‹¨ê³„. ë‚˜ì˜ ìƒí™œìŠµê´€ ì ê²€</h2>
    <div class="desc">í‰ì†Œ ìƒí™œì—ì„œ ì–¼ë§ˆë‚˜ ìì£¼ ê·¸ë ‡ê²Œ í•˜ëŠ”ì§€ ê³¨ë¼ ë³´ì„¸ìš”. ì •ë‹µÂ·ì˜¤ë‹µì´ ì•„ë‹ˆë¼, ë‚˜ë¥¼ ëŒì•„ë³´ëŠ” í™œë™ì…ë‹ˆë‹¤.</div>
    <div id="habitGrid" class="habit-grid"></div>
    <div class="habit-summary">
      <div>í˜„ì¬ê¹Œì§€ ì¶”ì • ìƒí™œìŠµê´€ ì ìˆ˜: <span id="habitPreview">0</span> / 28</div>
      <div id="habitLevel"></div>
    </div>
  </section>

  <!-- STEP 4 -->
  <section id="step4" class="screen">
    <div class="guide">
      <div class="guide-icon">ğŸ“‹</div>
      <div class="guide-text">ì§€ê¸ˆê¹Œì§€ì˜ ë‹µì„ ë°”íƒ•ìœ¼ë¡œ, ë‚˜ë§Œì˜ &lt;ë‚˜ì˜ ë°œë‹¬ ì¹´ë“œ&gt;ë¥¼ ë§Œë“¤ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤.</div>
    </div>
    <h2>4ë‹¨ê³„. ë‚˜ì˜ ë°œë‹¬ ì¹´ë“œ</h2>
    <div class="desc">í•„ìš”í•˜ë‹¤ë©´ ì´ë¦„ì„ ì ê³ , ë‚´ìš©ì„ ì½ì–´ ë³´ë©° ë‚˜ì˜ ê°•ì ê³¼ ì•ìœ¼ë¡œì˜ ëª©í‘œë¥¼ ìƒê°í•´ ë³´ì„¸ìš”.</div>

    <div class="result-card">
      <div class="result-strip"></div>
      <div class="result-body">
        <div class="result-header">
          <h3>ë‚˜ì˜ ë°œë‹¬ ì¹´ë“œ</h3>
          <div class="result-sub">5í•™ë…„ ì‹¤ê³¼ Â· ë‚˜ì˜ ë°œë‹¬</div>
        </div>
        <div class="name-row">
          ì´ë¦„: <input id="studentName" type="text" placeholder="ì´ë¦„ì„ ì ì–´ ë³´ì„¸ìš” (ì„ íƒ)">
        </div>

        <div id="domainBars" class="domain-bars"></div>

        <div id="domainAnalysis" class="analysis"></div>
        <div id="understandingAnalysis" class="analysis secondary"></div>
        <div id="habitAnalysis" class="analysis"></div>

        <div class="strengths">
          <div class="strength-box">
            <strong>â­ ë‚˜ì˜ ê°•ì  3ê°€ì§€</strong>
            <div id="strengthList"></div>
          </div>
          <div class="improve-box">
            <strong>ğŸ”§ ë³´ì™„í•˜ë©´ ì¢‹ì€ ì  2ê°€ì§€</strong>
            <div id="improveList"></div>
          </div>
        </div>

        <div class="prompt-area">
          <strong>ğŸ–¼ AIë¡œ ë‚˜ì˜ ë°œë‹¬ ìºë¦­í„° ê·¸ë ¤ë³´ê¸°</strong>
          <p>ì•„ë˜ í”„ë¡¬í”„íŠ¸ë¥¼ ë³µì‚¬í•´ì„œ ChatGPT ì´ë¯¸ì§€ ë§Œë“¤ê¸°ì— ë¶™ì—¬ë„£ìœ¼ë©´, ë‚˜ë¥¼ ë‹®ì€ ìºë¦­í„°ë¥¼ ê·¸ë ¤ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
          <textarea id="imagePrompt" readonly></textarea>
          <div class="btn-row" style="margin-top:6px;">
            <button id="btnCopy" class="secondary" type="button">í”„ë¡¬í”„íŠ¸ ë³µì‚¬</button>
            <div id="copyStatus"></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="footer">
    <div class="footer-left"><span id="stepHint">1ë‹¨ê³„: ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ í†µí•´ ë‚˜ì˜ ë³€í™”ë¥¼ ì‚´í´ë³´ëŠ” ì¤‘ì…ë‹ˆë‹¤.</span></div>
    <div class="btn-row">
      <button id="btnPrev" class="secondary" type="button" disabled>â—€ ì´ì „ ë‹¨ê³„</button>
      <button id="btnNext" type="button">ë‹¤ìŒ ë‹¨ê³„ë¡œ â–¶</button>
    </div>
  </div>
</div>

<script>
(function(){
  let currentStep = 1;
  const totalSteps = 4;

  const domainsMeta = {
    physical:{label:"ì‹ ì²´ ë°œë‹¬",emoji:"ğŸ’ª"},
    cognitive:{label:"ì¸ì§€ ë°œë‹¬",emoji:"ğŸ§ "},
    emotional:{label:"ì •ì„œ ë°œë‹¬",emoji:"ğŸ’–"},
    social:{label:"ì‚¬íšŒì„± ë°œë‹¬",emoji:"ğŸ¤"}
  };

  const step1Questions = [
    {id:1,domain:"physical",text:"í‚¤ë‚˜ ëª¸ë¬´ê²Œê°€ ì˜ˆì „ë³´ë‹¤ ë§ì´ ìë€ ê²ƒ ê°™ë‹¤."},
    {id:2,domain:"physical",text:"ë‹¬ë¦¬ê¸°, ì¤„ë„˜ê¸°, ì²´ìœ¡ í™œë™ì„ í•  ë•Œ ì˜ˆì „ë³´ë‹¤ ëœ í˜ë“¤ë‹¤."},
    {id:3,domain:"physical",text:"ë¬´ê±°ìš´ ë¬¼ê±´ì„ ë“¤ê±°ë‚˜, ì˜¤ë˜ ì„œ ìˆëŠ” ê²ƒì´ ì˜ˆì „ë³´ë‹¤ ì‰¬ì›Œì¡Œë‹¤."},
    {id:4,domain:"physical",text:"ëª¸ì´ ìë¼ëŠ” ê²ƒì— ê´€ì‹¬ì´ ìƒê¸°ê³ , ë‚´ ê±´ê°•ì— ëŒ€í•´ ë” ìƒê°í•˜ê²Œ ë˜ì—ˆë‹¤."},

    {id:5,domain:"cognitive",text:"ê¸€ì´ë‚˜ ë¬¸ì œì˜ ë‚´ìš©ì„ ì´í•´í•˜ëŠ” ì†ë„ê°€ ì˜ˆì „ë³´ë‹¤ ë¹¨ë¼ì§„ ê²ƒ ê°™ë‹¤."},
    {id:6,domain:"cognitive",text:"ë¬¸ì œë¥¼ í•´ê²°í•  ë•Œ í•œ ê°€ì§€ ë°©ë²•ë³´ë‹¤ ì—¬ëŸ¬ ê°€ì§€ ë°©ë²•ì„ ë– ì˜¬ë¦´ ìˆ˜ ìˆë‹¤."},
    {id:7,domain:"cognitive",text:"ë‰´ìŠ¤ë‚˜ ì‚¬íšŒ ë¬¸ì œë¥¼ ë“¤ì—ˆì„ ë•Œ, ë‚´ ìƒê°ì„ ë§í•´ ë³´ê³  ì‹¶ë‹¤ëŠ” ìƒê°ì´ ë“ ë‹¤."},
    {id:8,domain:"cognitive",text:"ê³„íšì„ ì„¸ìš°ê³  ìˆœì„œë¥¼ ì •í•´ ì¼ì„ ì²˜ë¦¬í•˜ëŠ” ì¼ì´ ì˜ˆì „ë³´ë‹¤ ìµìˆ™í•´ì¡Œë‹¤."},

    {id:9,domain:"emotional",text:"ê¸°ì˜ë‹¤, ìŠ¬í”„ë‹¤ ë¿ë§Œ ì•„ë‹ˆë¼ ì—¬ëŸ¬ ê°ì •ì„ ëŠë¼ëŠ” ì¼ì´ ë§ë‹¤."},
    {id:10,domain:"emotional",text:"ê°ì •ì´ ë„ˆë¬´ ì‹¬í•´ì§€ê¸° ì „ì—, ìŠ¤ìŠ¤ë¡œë¥¼ ì°¨ë¶„í•˜ê²Œ ë§Œë“¤ê¸° ìœ„í•´ ë…¸ë ¥í•´ ë³¸ ì ì´ ìˆë‹¤."},
    {id:11,domain:"emotional",text:"ì¹œêµ¬ë‚˜ ê°€ì¡±ì´ ì–´ë–¤ ê°ì •ì„ ëŠë¼ëŠ”ì§€ ì§ì‘í•˜ê³ , ê·¸ ë§ˆìŒì„ ì´í•´í•´ ë³´ë ¤ê³  í•œë‹¤."},
    {id:12,domain:"emotional",text:"í™”ê°€ ë‚˜ë„ ë¬¼ê±´ì„ ë˜ì§€ê±°ë‚˜ ì†Œë¦¬ë¥¼ ì§€ë¥´ê¸°ë³´ë‹¤ ë§ë¡œ í‘œí˜„í•˜ë ¤ê³  ë…¸ë ¥í•´ ë³¸ ì ì´ ìˆë‹¤."},

    {id:13,domain:"social",text:"ì¹œêµ¬ì™€ì˜ ê´€ê³„ê°€ ì˜ˆì „ë³´ë‹¤ ë” ì¤‘ìš”í•˜ê²Œ ëŠê»´ì§„ë‹¤."},
    {id:14,domain:"social",text:"ëª¨ë‘  í™œë™ì´ë‚˜ ë‹¨ì²´ ë†€ì´ì—ì„œ ë‹¤ë¥¸ ì‚¬ëŒì˜ ì˜ê²¬ì„ ë“¤ì–´ ë³´ë ¤ê³  í•œë‹¤."},
    {id:15,domain:"social",text:"ì¹œêµ¬ì™€ ë‹¤íˆ° ì ì´ ìˆì„ ë•Œ, ê·¸ëƒ¥ ë„˜ê¸°ê¸°ë³´ë‹¤ ëŒ€í™”ë¥¼ í†µí•´ í•´ê²°í•´ ë³´ë ¤ê³  í•œ ì ì´ ìˆë‹¤."},
    {id:16,domain:"social",text:"ë‚´ê°€ í•œ ë§ì´ë‚˜ í–‰ë™ì´ ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ ì–´ë–¤ ê¸°ë¶„ì„ ì¤„ì§€ ìƒê°í•´ ë³¸ ì ì´ ìˆë‹¤."}
  ];

  const quizData = [
    {
      tag:"ê°œì¸ì°¨ Â· ì‹ ì²´ ë°œë‹¬",
      text:"ë¯¼ìˆ˜ì™€ ì§€í›ˆì´ëŠ” ê°™ì€ ë°˜ ì¹œêµ¬ì…ë‹ˆë‹¤.\në¯¼ìˆ˜ëŠ” ë˜ë˜ë³´ë‹¤ í‚¤ê°€ ë¹¨ë¦¬ í¬ëŠ” í¸ì´ê³ , ì§€í›ˆì´ëŠ” ì•„ì§ í‚¤ê°€ ë§ì´ ìë¼ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\nì§€í›ˆì´ëŠ” 'ë‚œ ì™œ ì´ë ‡ê²Œ í‚¤ê°€ ì•ˆ í¬ì§€â€¦ ë­”ê°€ ì´ìƒí•œ ê±° ì•„ë‹ê¹Œ?' í•˜ê³  ê±±ì •í•©ë‹ˆë‹¤.\nì´ë•Œ ì§€í›ˆì´ê°€ ìƒê°í•˜ê±°ë‚˜ í–‰ë™í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ê°€ì¥ ì•Œë§ì€ ê²ƒì€ ë¬´ì—‡ì¼ê¹Œìš”?",
      options:[
        "ê³„ì† ì¹œêµ¬ì™€ ë¹„êµí•˜ë©´ì„œ ìì‹ ì˜ í‚¤ë¥¼ íƒ“í•œë‹¤.",
        "ì‚¬ëŒë§ˆë‹¤ ìë¼ëŠ” ì†ë„ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤ê³  ìƒê°í•˜ê³ , ê·œì¹™ì ìœ¼ë¡œ ìê³  ì˜ ë¨¹ëŠ” ë“± ê±´ê°•ì„ ì±™ê¸´ë‹¤.",
        "ì ì‹¬ì„ ê±°ì˜ ë¨¹ì§€ ì•Šê³  ë‹¤ì´ì–´íŠ¸ë¥¼ í•˜ê¸°ë¡œ í•œë‹¤."
      ],
      correct:1
    },
    {
      tag:"ì‹ ì²´ ë†€ë¦¼ ê¸ˆì§€",
      text:"ì§€ì€ì´ëŠ” ì¹œêµ¬ ìˆ˜ì•„ê°€ ì˜ˆì „ë³´ë‹¤ í‚¤ë„ í¬ê³  ëª¸ë„ ë‹¬ë¼ì§„ ê²ƒ ê°™ë‹¤ê³  ëŠê¼ˆìŠµë‹ˆë‹¤.\nëª‡ëª‡ ì¹œêµ¬ë“¤ì€ 'ì•¼, ë„ˆ ì™œ ì´ë ‡ê²Œ ë‹¬ë¼ì¡Œì–´? ì´ìƒí•´~'ë¼ê³  ì¥ë‚œì„ ì¹˜ë©° ë†€ë¦½ë‹ˆë‹¤.\nì´ë•Œ ì§€ì€ì´ê°€ í•´ì•¼ í•  í–‰ë™ìœ¼ë¡œ ê°€ì¥ ë°”ëŒì§í•œ ê²ƒì€ ë¬´ì—‡ì¼ê¹Œìš”?",
      options:[
        "ê°™ì´ ì›ƒìœ¼ë©´ì„œ 'ê·¸ë˜, ë„ˆ ì¢€ ì´ìƒí•´.'ë¼ê³  ë§í•œë‹¤.",
        "ëª¸ì´ ìë¼ëŠ” ê²ƒì€ ëˆ„êµ¬ì—ê²Œë‚˜ ìì—°ìŠ¤ëŸ¬ìš´ ì¼ì´ë¼ê³  ë§í•˜ë©°, ì¹œêµ¬ë¥¼ ë†€ë¦¬ì§€ ë§ë¼ê³  í•œë‹¤.",
        "ê·¸ëƒ¥ ëª¨ë¥¸ ì²™ ì¡°ìš©íˆ ìˆê³ , ì†ìœ¼ë¡œë§Œ ë¶ˆí¸í•˜ë‹¤ê³  ìƒê°í•œë‹¤."
      ],
      correct:1
    },
    {
      tag:"ì •ì„œ Â· ê°ì • ì¡°ì ˆ",
      text:"ì£¼ì›ì´ëŠ” ë°œí‘œ ì‹œê°„ì— ì¹œêµ¬ê°€ í‹€ë¦° ë¶€ë¶„ì„ ì§€ì í•˜ì, ì°½í”¼í•˜ê¸°ë„ í•˜ê³  í™”ë„ ë‚˜ê³  ì–µìš¸í•œ ë§ˆìŒë„ ë“¤ì—ˆìŠµë‹ˆë‹¤.\nì£¼ì›ì´ëŠ” ì´ëŸ° ê°ì •ì„ ì–´ë–»ê²Œ ë‹¤ë£¨ë©´ ì¢‹ì„ê¹Œìš”?",
      options:[
        "ê·¸ ìë¦¬ì—ì„œ í¬ê²Œ ì†Œë¦¬ë¥¼ ì§€ë¥´ê³  ì¹œêµ¬ì—ê²Œ ìš•ì„ í•œë‹¤.",
        "ì—¬ëŸ¬ ê°ì •ì´ ì„ì—¬ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œì•„ì°¨ë¦¬ê³ , ì°¨ë¶„í•´ì¡Œì„ ë•Œ ì¹œêµ¬ì™€ ì´ì•¼ê¸°í•˜ê±°ë‚˜ ì„ ìƒë‹˜ê»˜ ë„ì›€ì„ ìš”ì²­í•œë‹¤.",
        "ì´ëŸ° ê°ì •ì„ ëŠë¼ëŠ” ê²ƒì€ ì˜ëª»ì´ë¼ê³  ìƒê°í•˜ë©° ì•„ë¬´ ê°ì •ë„ ëŠë¼ì§€ ì•Šìœ¼ë ¤ê³  í•œë‹¤."
      ],
      correct:1
    },
    {
      tag:"ìƒí™œìŠµê´€ Â· ìˆ˜ë©´",
      text:"í•˜ëŠ˜ì´ëŠ” ë°¤ëŠ¦ê²Œê¹Œì§€ ê²Œì„ì„ í•˜ëŠë¼ ìì£¼ ìƒˆë²½ 1~2ì‹œì— ì ì´ ë“­ë‹ˆë‹¤.\nì•„ì¹¨ì—ëŠ” í”¼ê³¤í•´ì„œ ì¼ì–´ë‚˜ê¸° í˜ë“¤ê³ , ìˆ˜ì—… ì‹œê°„ì—ë„ ìê¾¸ ì¡¸ë¦½ë‹ˆë‹¤.\ní•˜ëŠ˜ì´ê°€ ê±´ê°•í•œ ë°œë‹¬ì„ ìœ„í•´ ë…¸ë ¥í•´ì•¼ í•  í–‰ë™ìœ¼ë¡œ ê°€ì¥ ì•Œë§ì€ ê²ƒì€ ë¬´ì—‡ì¼ê¹Œìš”?",
      options:[
        "ì–´ë¦´ ë•ŒëŠ” ë§ì´ ë†€ì•„ë„ ê´œì°®ë‹¤ê³  ìƒê°í•˜ë©° ê·¸ëŒ€ë¡œ ìƒí™œí•œë‹¤.",
        "ì ì´ ë¶€ì¡±í•œ ê²ƒì´ ê±´ê°•ì— ì¢‹ì§€ ì•Šë‹¤ëŠ” ê²ƒì„ ì•Œê³ , ê²Œì„ ì‹œê°„ì„ ì¤„ì´ê³  ì¼ì •í•œ ì‹œê°„ì— ìë ¤ê³  í•œë‹¤.",
        "ë‚®ì— ë” ë§ì´ ìì„œ ë°¤ì— ê³„ì† ê²Œì„ì„ í•  ìˆ˜ ìˆë„ë¡, ìˆ˜ì—… ì‹œê°„ì— ì ë²„ë¦°ë‹¤."
      ],
      correct:1
    },
    {
      tag:"ì„±ì  ë°œë‹¬ Â· ë„ì›€ ìš”ì²­",
      text:"ì„œì¤€ì´ëŠ” ìµœê·¼ì— ë°¤ì— ê°‘ìê¸° ì†ì˜·ì´ ì –ëŠ” ê²½í—˜(ëª½ì •)ì„ í–ˆìŠµë‹ˆë‹¤.\nì²˜ìŒ ê²ªëŠ” ì¼ì´ë¼ ë†€ë¼ê³  ë¶€ë„ëŸ¬ì›Œì„œ ì•„ë¬´ì—ê²Œë„ ë§í•˜ì§€ ëª»í•˜ê³  ìˆìŠµë‹ˆë‹¤.\nì„œì¤€ì´ê°€ ê°€ì¥ ë°”ë¥´ê²Œ í–‰ë™í•˜ëŠ” ë°©ë²•ì€ ë¬´ì—‡ì¼ê¹Œìš”?",
      options:[
        "í°ì¼ì´ ë‚œ ê²ƒ ê°™ë‹¤ê³  ìƒê°í•˜ë©° ì•„ë¬´ì—ê²Œë„ ë§í•˜ì§€ ì•Šê³  í˜¼ì ê±±ì •ë§Œ í•œë‹¤.",
        "ì´ëŸ° ë³€í™”ê°€ ìì—°ìŠ¤ëŸ¬ìš´ ë°œë‹¬ ê³¼ì •ì„ì„ ì•Œê³ , ë¯¿ì„ ìˆ˜ ìˆëŠ” ì–´ë¥¸ì—ê²Œ ë¬¼ì–´ë³´ê³  ëª¸ê³¼ ì†ì˜·ì„ ê¹¨ë—ì´ ê´€ë¦¬í•œë‹¤.",
        "ì´ ì¼ì„ ìŠê¸° ìœ„í•´ ê²Œì„ì´ë‚˜ ì˜ìƒì„ ê³„ì† ë³´ë©° ë„˜ê²¨ ë²„ë¦°ë‹¤."
      ],
      correct:1
    },
    {
      tag:"ì‚¬íšŒì„± Â· ê³µê°",
      text:"ë°˜ì—ì„œ ëŠ˜ ì¡°ìš©íˆ í˜¼ì ìˆëŠ” ì¹œêµ¬ê°€ ìˆìŠµë‹ˆë‹¤.\nì‰¬ëŠ” ì‹œê°„ì—ë„ í˜¼ì ì±…ë§Œ ë³´ê³ , ì ì‹¬ì‹œê°„ì—ë„ ê±°ì˜ ë§ì„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\nê·¸ ì¹œêµ¬ë¥¼ ë³¸ ë‚´ê°€ í•  ìˆ˜ ìˆëŠ” í–‰ë™ìœ¼ë¡œ ê°€ì¥ ë°”ëŒì§í•œ ê²ƒì€ ë¬´ì—‡ì¼ê¹Œìš”?",
      options:[
        "í˜¼ì ìˆëŠ” ê²Œ í¸í•œê°€ ë³´ë‹¤ í•˜ê³  ì•„ë¬´ ê´€ì‹¬ì„ ê°–ì§€ ì•ŠëŠ”ë‹¤.",
        "ê°€ë³ê²Œ ë¨¼ì € ë§ì„ ê±¸ê±°ë‚˜, í•¨ê»˜ ë†€ìê³  ì´ˆëŒ€í•´ ë³´ë©° ì²œì²œíˆ ì¹œí•´ì§ˆ ê¸°íšŒë¥¼ ë§Œë“ ë‹¤.",
        "ì™œ ë§¨ë‚  í˜¼ìëƒê³  ë†€ë¦¬ë©° ì£¼ë³€ ì¹œêµ¬ë“¤ê³¼ í•¨ê»˜ ì›ƒëŠ”ë‹¤."
      ],
      correct:1
    }
  ];

  const habitItems = [
    {id:1,cat:"ìˆ˜ë©´Â·íœ´ì‹ ğŸ˜´",text:"ëŒ€ë¶€ë¶„ì˜ ë‚ ì—, ë°¤ì— ì •í•´ì§„ ì‹œê°„ì— ìë ¤ê³  ë…¸ë ¥í•œë‹¤."},
    {id:2,cat:"ìˆ˜ë©´Â·íœ´ì‹ ğŸ˜´",text:"ì ì„ ì¶©ë¶„íˆ ìê³ , ì•„ì¹¨ì— ì¼ì–´ë‚¬ì„ ë•Œ ë„ˆë¬´ í”¼ê³¤í•˜ì§€ ì•Šë‹¤."},

    {id:3,cat:"ìš´ë™Â·ê±´ê°• ğŸƒâ€â™‚ï¸",text:"ì¼ì£¼ì¼ì— ì—¬ëŸ¬ ë²ˆ, ëª¸ì„ ì›€ì§ì´ëŠ” ìš´ë™ì„ í•˜ê±°ë‚˜ í™œë™ì„ í•œë‹¤."},
    {id:4,cat:"ìš´ë™Â·ê±´ê°• ğŸƒâ€â™‚ï¸",text:"ì•‰ì•„ ìˆì„ ë•Œ ì˜¬ë°”ë¥¸ ìì„¸ë¥¼ ìœ ì§€í•˜ë ¤ê³  í•œë‹¤."},
    {id:5,cat:"ìš´ë™Â·ê±´ê°• ğŸƒâ€â™‚ï¸",text:"ì‹œë ¥ì´ ë‚˜ë¹ ì§€ì§€ ì•Šë„ë¡ ìŠ¤ë§ˆíŠ¸í°ì´ë‚˜ ì±…ì„ ë„ˆë¬´ ê°€ê¹Œì´ ë³´ì§€ ì•Šìœ¼ë ¤ê³  í•œë‹¤."},

    {id:6,cat:"ìœ„ìƒÂ·ëª¸ ê´€ë¦¬ ğŸ§¼",text:"ëª¸ì„ ê¹¨ë—í•˜ê²Œ ì”»ê³ , ì†ì˜·Â·ì–‘ë§ì„ ë§¤ì¼ ê°ˆì•„ì…ëŠ”ë‹¤."},
    {id:7,cat:"ìœ„ìƒÂ·ëª¸ ê´€ë¦¬ ğŸ§¼",text:"ë•€ì„ ë§ì´ í˜ë ¸ì„ ë•Œ, ì˜·ì„ ê°ˆì•„ì…ê±°ë‚˜ ìƒ¤ì›Œë¥¼ í•œë‹¤."},
    {id:8,cat:"ìœ„ìƒÂ·ëª¸ ê´€ë¦¬ ğŸ§¼",text:"ëª¸ì—ì„œ ë³€í™”ê°€ ìˆì„ ë•Œ(ì—¬ë“œë¦„Â·ì›”ê²½Â·ëª½ì • ë“±) ì²­ê²°ì„ ìœ ì§€í•˜ë ¤ê³  í•œë‹¤."},

    {id:9,cat:"ì •ì„œÂ·ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ ğŸ’­",text:"í™”ê°€ ë‚˜ê±°ë‚˜ ì†ìƒí•  ë•Œ, ë‚˜ë¥¼ ì°¨ë¶„í•˜ê²Œ ë§Œë“¤ê¸° ìœ„í•œ ë°©ë²•ì„ ì‚¬ìš©í•˜ë ¤ê³  í•œë‹¤."},
    {id:10,cat:"ì •ì„œÂ·ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ ğŸ’­",text:"í˜¼ì í•´ê²°í•˜ê¸° ì–´ë ¤ìš´ ê³ ë¯¼ì´ ìˆì„ ë•Œ, ë¯¿ì„ ìˆ˜ ìˆëŠ” ì–´ë¥¸ì—ê²Œ ë„ì›€ì„ ìš”ì²­í•œë‹¤."},

    {id:11,cat:"ë¯¸ë””ì–´ ì‚¬ìš© ğŸ“±",text:"ìŠ¤ë§ˆíŠ¸í°ì´ë‚˜ ê²Œì„ ì‹œê°„ì„ ìŠ¤ìŠ¤ë¡œ ì¡°ì ˆí•˜ë ¤ê³  ë…¸ë ¥í•œë‹¤."},
    {id:12,cat:"ë¯¸ë””ì–´ ì‚¬ìš© ğŸ“±",text:"ì ë“¤ê¸° ì „ì— ìŠ¤ë§ˆíŠ¸í°Â·íƒœë¸”ë¦¿ì„ ì˜¤ë˜ ë³´ì§€ ì•Šìœ¼ë ¤ê³  í•œë‹¤."},

    {id:13,cat:"ì„±ì  ë°œë‹¬ ê´€ë ¨ ğŸ”",text:"ëª¸ì˜ ë³€í™”ë¥¼ ë†€ë¦¬ì§€ ì•Šê³  ìì—°ìŠ¤ëŸ½ê²Œ ë°›ì•„ë“¤ì´ë ¤ê³  í•œë‹¤."},
    {id:14,cat:"ì„±ì  ë°œë‹¬ ê´€ë ¨ ğŸ”",text:"ìœ í•´í•œ ì˜ìƒÂ·ìŒë€ë¬¼Â·í­ë ¥ì  ì˜ìƒì„ ë³´ì§€ ì•Šìœ¼ë ¤ê³  ì¡°ì‹¬í•œë‹¤."}
  ];

  const step1Checked = new Set();
  let quizIndex = 0;
  const quizAnswers = new Array(quizData.length).fill(null); // 0,1,2
  const habitAnswers = {}; // id -> 1(ê±°ì˜X),2(ë³´í†µ),3(í•­ìƒ)

  function qs(id){return document.getElementById(id);}

  function updateStepper(){
    const progress = qs("stepProgress");
    progress.style.width = ((currentStep-1)/(totalSteps-1))*100 + "%";

    document.querySelectorAll(".screen").forEach(sec=>{
      sec.classList.toggle("active", sec.id === "step"+currentStep);
    });
    document.querySelectorAll(".step-dot").forEach(dot=>{
      const s = parseInt(dot.dataset.step,10);
      dot.classList.toggle("active", s===currentStep);
    });

    const hint = qs("stepHint");
    if(currentStep===1) hint.textContent="1ë‹¨ê³„: ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ í†µí•´ ë‚˜ì˜ ë³€í™”ë¥¼ ì‚´í´ë³´ëŠ” ì¤‘ì…ë‹ˆë‹¤.";
    else if(currentStep===2) hint.textContent="2ë‹¨ê³„: ìƒí™©ë³„ë¡œ ì–´ë–¤ ì„ íƒì´ ë„ì›€ì´ ë˜ëŠ”ì§€ ìƒê°í•˜ë©° í€´ì¦ˆë¥¼ í’€ì–´ë³´ëŠ” ì¤‘ì…ë‹ˆë‹¤.";
    else if(currentStep===3) hint.textContent="3ë‹¨ê³„: ìˆ˜ë©´Â·ìš´ë™Â·ìœ„ìƒÂ·ë¯¸ë””ì–´ ì‚¬ìš© ë“± ìƒí™œìŠµê´€ì„ ì ê²€í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤.";
    else hint.textContent="4ë‹¨ê³„: ì§€ê¸ˆê¹Œì§€ì˜ ë‹µì„ ë°”íƒ•ìœ¼ë¡œ ë‚˜ì˜ ë°œë‹¬ ì¹´ë“œë¥¼ í™•ì¸í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤.";

    qs("btnPrev").disabled = currentStep===1;
    qs("btnNext").textContent = currentStep===4 ? "ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸° ğŸ”" : "ë‹¤ìŒ ë‹¨ê³„ë¡œ â–¶";
  }

  function renderStep1(){
    const grid = qs("domainGrid");
    grid.innerHTML = "";
    const group = {physical:[],cognitive:[],emotional:[],social:[]};
    step1Questions.forEach(q=>group[q.domain].push(q));

    Object.keys(group).forEach(key=>{
      const card = document.createElement("div");
      card.className="domain-card";
      const h = document.createElement("div");
      h.className="domain-header";
      const t = document.createElement("div");
      t.className="domain-title";
      t.textContent = domainsMeta[key].emoji + " " + domainsMeta[key].label;
      const chip = document.createElement("div");
      chip.className="domain-chip";
      const cnt = step1Questions.filter(q=>q.domain===key && step1Checked.has(q.id)).length;
      chip.textContent="ì²´í¬ "+cnt+"/4";
      h.appendChild(t);h.appendChild(chip);
      card.appendChild(h);

      group[key].forEach(q=>{
        const row = document.createElement("label");
        row.className="question-row";
        const inp = document.createElement("input");
        inp.type="checkbox";
        inp.checked = step1Checked.has(q.id);
        inp.addEventListener("change",()=>{
          if(inp.checked) step1Checked.add(q.id);
          else step1Checked.delete(q.id);
          renderStep1();
        });
        const text = document.createElement("div");
        text.textContent = q.text;
        row.appendChild(inp);row.appendChild(text);
        card.appendChild(row);
      });
      grid.appendChild(card);
    });
  }

  function renderQuiz(){
    const q = quizData[quizIndex];
    const card = qs("quizCard");
    card.innerHTML="";

    const top = document.createElement("div");
    top.className="quiz-top";
    const left = document.createElement("div");
    left.textContent = "ë¬¸ì œ "+(quizIndex+1)+" / "+quizData.length;
    const tag = document.createElement("div");
    tag.className="quiz-tag";tag.textContent=q.tag;
    top.appendChild(left);top.appendChild(tag);

    const qDiv = document.createElement("div");
    qDiv.className="quiz-q";qDiv.textContent=q.text;

    const optWrap = document.createElement("div");
    optWrap.className="quiz-options";
    ["A","B","C"].forEach((lab,i)=>{
      const div=document.createElement("div");
      div.className="option-card";
      if(quizAnswers[quizIndex]===i) div.classList.add("selected");
      const s1=document.createElement("span");s1.className="label";s1.textContent=lab;
      const s2=document.createElement("span");s2.textContent=q.options[i];
      div.appendChild(s1);div.appendChild(s2);
      div.addEventListener("click",()=>{
        quizAnswers[quizIndex]=i;
        renderQuiz();
      });
      optWrap.appendChild(div);
    });

    card.appendChild(top);card.appendChild(qDiv);card.appendChild(optWrap);

    let dots="";
    for(let i=0;i<quizData.length;i++){
      const done = quizAnswers[i]!==null;
      if(i===quizIndex) dots += done?"â— ":"â—‰ ";
      else dots += done?"â— ":"â—‹ ";
    }
    qs("quizDots").textContent=dots.trim();
  }

  function renderHabits(){
    const grid = qs("habitGrid");
    grid.innerHTML="";
    const grouped={};
    habitItems.forEach(h=>{
      if(!grouped[h.cat]) grouped[h.cat]=[];
      grouped[h.cat].push(h);
    });

    Object.keys(grouped).forEach(cat=>{
      const box=document.createElement("div");
      box.className="habit-cat";
      const title=document.createElement("div");
      title.className="habit-title";
      title.textContent=cat;
      box.appendChild(title);

      grouped[cat].forEach(item=>{
        const wrap=document.createElement("div");
        wrap.className="habit-item";
        const t=document.createElement("div");
        t.className="habit-text";
        t.textContent=item.text;
        const scale=document.createElement("div");
        scale.className="habit-scale";
        const opts=[
          {v:3,label:"í•­ìƒ"},
          {v:2,label:"ë³´í†µ"},
          {v:1,label:"ê±°ì˜ ì•„ë‹ˆë‹¤"}
        ];
        opts.forEach(o=>{
          const btn=document.createElement("button");
          btn.type="button";
          btn.className="habit-btn";
          if(habitAnswers[item.id]===o.v) btn.classList.add("selected");
          btn.textContent=o.label;
          btn.addEventListener("click",()=>{
            habitAnswers[item.id]=o.v;
            renderHabits();
            updateHabitPreview();
          });
          scale.appendChild(btn);
        });
        wrap.appendChild(t);wrap.appendChild(scale);
        box.appendChild(wrap);
      });

      grid.appendChild(box);
    });
    updateHabitPreview();
  }

  function updateHabitPreview(){
    let score=0,answered=0;
    habitItems.forEach(h=>{
      const v = habitAnswers[h.id] || 0;
      if(v>0) answered++;
      if(v===2) score+=1;
      else if(v===3) score+=2;
    });
    qs("habitPreview").textContent=score;
    const lv = qs("habitLevel");
    if(!answered) lv.textContent="ì•„ì§ ì„ íƒí•œ ë¬¸í•­ì´ ê±°ì˜ ì—†ì–´ìš”.";
    else if(score>=23) lv.textContent="ìƒí™œìŠµê´€ì´ ì „ë°˜ì ìœ¼ë¡œ ë§¤ìš° ê±´ê°•í•œ í¸ì´ì—ìš”!";
    else if(score>=15) lv.textContent="ìƒí™œìŠµê´€ì´ ë³´í†µ ì´ìƒì´ì—ìš”. í•œë‘ ê°€ì§€ë¥¼ ë³´ì™„í•˜ë©´ ë” ì¢‹ì•„ì§ˆ ìˆ˜ ìˆì–´ìš”.";
    else lv.textContent="ìƒí™œìŠµê´€ì„ ì¡°ê¸ˆ ë” ì •ë¦¬í•´ ë³´ë©´ ì¢‹ê² ì–´ìš”.";
  }

  function getDomainScores(){
    const scores={physical:0,cognitive:0,emotional:0,social:0};
    step1Questions.forEach(q=>{
      if(step1Checked.has(q.id)) scores[q.domain]++;
    });
    return scores;
  }

  function getDomainText(key,score){
    const label = domainsMeta[key].label;
    if(key==="physical"){
      if(score<=1) return "â— "+label+"\nì•„ì§ì€ ëª¸ì˜ ë³€í™”ë¥¼ í¬ê²Œ ëŠë¼ì§€ ëª»í•  ìˆ˜ë„ ìˆì–´ìš”.\nì•ìœ¼ë¡œ í‚¤ì™€ ì²´ë ¥ ë³€í™”ì— ì¡°ê¸ˆ ë” ê´€ì‹¬ì„ ê°€ì ¸ ë³´ë©´ ì¢‹ì•„ìš”.";
      if(score<=3) return "â— "+label+"\nëª¸ì´ ìë¼ê³  ìˆë‹¤ëŠ” ê²ƒì„ ì˜ ëŠë¼ê³  ìˆì–´ìš”.\nìš´ë™Â·ìˆ˜ë©´Â·ì‹ìŠµê´€ì„ ì˜ ìœ ì§€í•˜ë©´ ë”ìš± ê±´ê°•í•˜ê²Œ ì„±ì¥í•  ìˆ˜ ìˆì–´ìš”.";
      return "â— "+label+"\nì‹ ì²´ê°€ ìë¼ëŠ” ëª¨ìŠµì„ ì˜ ì´í•´í•˜ê³  ìˆë„¤ìš”.\nì§€ê¸ˆì²˜ëŸ¼ ê±´ê°•ì„ ì†Œì¤‘íˆ ì—¬ê¸°ë©´ í›Œë¥­í•˜ê²Œ ì„±ì¥í•  ìˆ˜ ìˆì–´ìš”.";
    }
    if(key==="cognitive"){
      if(score<=1) return "â— "+label+"\nìƒê°ì´ë‚˜ í•™ìŠµì—ì„œì˜ ë³€í™”ë¥¼ ì•„ì§ ë§ì´ ëŠë¼ì§€ ëª»í•  ìˆ˜ë„ ìˆì–´ìš”.\nê³„íš ì„¸ìš°ê¸°ì™€ ë‹¤ì–‘í•œ í•´ê²° ë°©ë²•ì„ ì—°ìŠµí•´ ë³´ë©´ ì¢‹ì•„ìš”.";
      if(score<=3) return "â— "+label+"\në¬¸ì œë¥¼ ì—¬ëŸ¬ ë°©ì‹ìœ¼ë¡œ í•´ê²°í•˜ê³ , ë³µì¡í•œ ë‚´ìš©ì„ ì´í•´í•˜ëŠ” ëŠ¥ë ¥ì´ ìë¼ê³  ìˆì–´ìš”.";
      return "â— "+label+"\në…¼ë¦¬ì ìœ¼ë¡œ ìƒê°í•˜ê³  ê³„íšì„ ì„¸ìš°ëŠ” ëŠ¥ë ¥ì´ ì˜ ë°œë‹¬í•˜ê³  ìˆì–´ìš”.";
    }
    if(key==="emotional"){
      if(score<=1) return "â— "+label+"\nì—¬ëŸ¬ ê°ì •ì„ ìŠ¤ìŠ¤ë¡œ ì´í•´í•˜ê³  í‘œí˜„í•˜ëŠ” ì—°ìŠµì´ ì¡°ê¸ˆ ë” í•„ìš”í•´ìš”.\nê°ì •ì„ ì¸ì •í•˜ê³  ë§ë¡œ í‘œí˜„í•˜ëŠ” ì—°ìŠµì„ í•´ ë³´ë©´ ë„ì›€ì´ ë©ë‹ˆë‹¤.";
      if(score<=3) return "â— "+label+"\nê°ì •ì„ ë‹¤ì–‘í•˜ê²Œ ëŠë¼ê³ , ì°¨ë¶„í•˜ê²Œ ì¡°ì ˆí•˜ë ¤ëŠ” ë…¸ë ¥ì´ ë³´ì…ë‹ˆë‹¤.";
      return "â— "+label+"\nê°ì •ì„ ì˜ ì¸ì‹í•˜ê³  ë§ì„ í†µí•´ í‘œí˜„í•˜ë ¤ëŠ” í›Œë¥­í•œ ì •ì„œ ì¡°ì ˆ ëŠ¥ë ¥ì„ ê°€ì§€ê³  ìˆì–´ìš”.";
    }
    if(key==="social"){
      if(score<=1) return "â— "+label+"\nì¹œêµ¬ì™€ì˜ ê´€ê³„ì—ì„œ ë” ë”°ëœ»í•˜ê³  ì ê·¹ì ì¸ ì†Œí†µì„ ì—°ìŠµí•´ ë³´ë©´ ì¢‹ì•„ìš”.";
      if(score<=3) return "â— "+label+"\në‹¤ë¥¸ ì‚¬ëŒì˜ ê¸°ë¶„ì„ ìƒê°í•˜ê³ , ëŒ€í™”ë¥¼ í†µí•´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ëŠ” ëª¨ìŠµì´ ë³´ì—¬ìš”.";
      return "â— "+label+"\nì¹œêµ¬ì™€ í˜‘ë ¥í•˜ê³  ë°°ë ¤í•˜ë©° ê´€ê³„ë¥¼ ì˜ ìœ ì§€í•˜ëŠ” ë©‹ì§„ ì‚¬íšŒì„±ì„ ê°€ì§€ê³  ìˆì–´ìš”.";
    }
    return "";
  }

  function getUnderstandingScore(){
    let s=0;
    quizData.forEach((q,i)=>{
      if(quizAnswers[i]===q.correct) s++;
    });
    return s;
  }

  function getUnderstandingText(score){
    if(score>=5) return "â— ë°œë‹¬ ì´í•´ ì ìˆ˜: ë§¤ìš° ì¢‹ìŒ ("+score+" / 6ì )\nì•„ë™ê¸°ì˜ ë°œë‹¬ì„ ì˜ ì´í•´í•˜ê³ , ì¹œêµ¬ì™€ ìì‹ ì„ ì¡´ì¤‘í•˜ëŠ” íƒœë„ê°€ ì•„ì£¼ ì¢‹ì•„ìš”.";
    if(score>=3) return "â— ë°œë‹¬ ì´í•´ ì ìˆ˜: ë³´í†µ ("+score+" / 6ì )\në°œë‹¬ì— ëŒ€í•œ ì´í•´ëŠ” ì¢‹ì€ í¸ì´ì§€ë§Œ, ëª‡ ê°€ì§€ ìƒí™©ì—ì„œëŠ” ì¡°ê¸ˆ ë” ìƒê°í•´ ë³´ë©´ ë” ë‚˜ì€ ì„ íƒì„ í•  ìˆ˜ ìˆì–´ìš”.";
    return "â— ë°œë‹¬ ì´í•´ ì ìˆ˜: ë³´ì™„ í•„ìš” ("+score+" / 6ì )\nì•„ë™ê¸°ì˜ ë°œë‹¬ê³¼ ê´€ë ¨ëœ ìƒí™©ì„ ë‹¤ì‹œ í•œ ë²ˆ ì •ë¦¬í•´ ë³¼ í•„ìš”ê°€ ìˆì–´ìš”.\nêµê³¼ì„œ ë‚´ìš©ì„ ë‹¤ì‹œ ì½ê³ , ì„ ìƒë‹˜ê³¼ í•¨ê»˜ ì–´ë–¤ ì„ íƒì´ ë„ì›€ì´ ë˜ëŠ”ì§€ ì´ì•¼ê¸°í•´ ë³´ë©´ ì¢‹ìŠµë‹ˆë‹¤.";
  }

  function getHabitScore(){
    let score=0;
    habitItems.forEach(h=>{
      const v = habitAnswers[h.id] || 0;
      if(v===2) score+=1;
      else if(v===3) score+=2;
    });
    return score;
  }

  function getHabitText(score){
    if(score>=23) return "â— ìƒí™œìŠµê´€ ì ìˆ˜: ë§¤ìš° ê±´ê°• ("+score+" / 28ì )\nìˆ˜ë©´Â·ìš´ë™Â·ìœ„ìƒÂ·ë¯¸ë””ì–´ ì‚¬ìš© ë“± ìƒí™œìŠµê´€ì´ ì•„ì£¼ ê±´ê°•í•œ í¸ì´ì—ìš”.\nì´ëŸ° ì¢‹ì€ ìŠµê´€ì€ ë°œë‹¬ì— í° ë„ì›€ì´ ë©ë‹ˆë‹¤.";
    if(score>=15) return "â— ìƒí™œìŠµê´€ ì ìˆ˜: ë³´í†µ ("+score+" / 28ì )\nëŒ€ë¶€ë¶„ì˜ ìƒí™œìŠµê´€ì€ ê´œì°®ì§€ë§Œ, ëª‡ ê°€ì§€ë¥¼ ì¡°ê¸ˆ ë” ì‹ ê²½ ì“°ë©´ ë” ê±´ê°•í•˜ê²Œ ìë„ ìˆ˜ ìˆì–´ìš”.";
    return "â— ìƒí™œìŠµê´€ ì ìˆ˜: ë³´ì™„ í•„ìš” ("+score+" / 28ì )\nìƒí™œìŠµê´€ì„ í•œ ë²ˆ ì •ë¦¬í•´ ë³¼ í•„ìš”ê°€ ìˆì–´ìš”.\nê·œì¹™ì ì¸ ìˆ˜ë©´, ì ë‹¹í•œ ìš´ë™, ìœ„ìƒ ê´€ë¦¬, ìŠ¤ë§ˆíŠ¸í° ì‚¬ìš© ì¡°ì ˆ ë“±ì„ ì°¨ê·¼ì°¨ê·¼ ë°”ê¿” ë³´ë©´ ì¢‹ìŠµë‹ˆë‹¤.";
  }

  function buildStrengthsAndImprovements(domainScores,underScore,habitScore){
    const strengths=[],improves=[];
    if(domainScores.physical>=3) strengths.push("ëª¸ì˜ ë³€í™”ë¥¼ ì˜ ëŠë¼ê³ , ê±´ê°•ì„ ì†Œì¤‘íˆ ì—¬ê¸°ë ¤ëŠ” íƒœë„ê°€ ì¢‹ì•„ìš”.");
    if(domainScores.cognitive>=3) strengths.push("ë¬¸ì œë¥¼ ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ í•´ê²°í•˜ê³ , ìŠ¤ìŠ¤ë¡œ ìƒê°í•˜ëŠ” í˜ì´ ì˜ ìë¼ê³  ìˆì–´ìš”.");
    if(domainScores.emotional>=3) strengths.push("ê°ì •ì„ ì˜ ì•Œì•„ì°¨ë¦¬ê³  ì°¨ë¶„í•˜ê²Œ í‘œí˜„í•˜ë ¤ëŠ” ë…¸ë ¥ì´ ë‹ë³´ì…ë‹ˆë‹¤.");
    if(domainScores.social>=3) strengths.push("ì¹œêµ¬ì˜ ê¸°ë¶„ì„ ìƒê°í•˜ê³ , ëŒ€í™”ë¥¼ í†µí•´ ê´€ê³„ë¥¼ ì§€í‚¤ë ¤ëŠ” ëª¨ìŠµì´ ë©‹ì ¸ìš”.");
    if(underScore>=5) strengths.push("ë°œë‹¬ì„ ë°”ë¥´ê²Œ ì´í•´í•˜ê³ , ë‚˜ì™€ ì¹œêµ¬ë¥¼ ì¡´ì¤‘í•˜ëŠ” íƒœë„ê°€ ì˜ ìë¦¬ ì¡í˜€ ìˆì–´ìš”.");
    if(habitScore>=23) strengths.push("ìƒí™œìŠµê´€ì´ ì „ë°˜ì ìœ¼ë¡œ ê±´ê°•í•´ì„œ ì•ìœ¼ë¡œì˜ ì„±ì¥ì—ë„ í° ë„ì›€ì´ ë  ê±°ì˜ˆìš”.");

    if(domainScores.physical<=1) improves.push("ìš´ë™Â·ìˆ˜ë©´Â·ì‹ìŠµê´€ì„ ì¡°ê¸ˆ ë” ì±™ê²¨ ë³´ë©´ ì¢‹ê² ì–´ìš”.");
    if(domainScores.cognitive<=1) improves.push("ê³„íšì„ ì„¸ìš°ê³  ìˆœì„œë¥¼ ì •í•´ ì¼ì„ ì²˜ë¦¬í•˜ëŠ” ì—°ìŠµì„ ì¡°ê¸ˆ ë” í•´ ë³´ë©´ ì¢‹ì•„ìš”.");
    if(domainScores.emotional<=1) improves.push("ê°ì •ì„ ì°¸ê¸°ë³´ë‹¤ ì•ˆì „í•˜ê²Œ í‘œí˜„í•˜ëŠ” ì—°ìŠµì„ í•´ ë³´ë©´ ì¢‹ê² ì–´ìš”.");
    if(domainScores.social<=1) improves.push("ì¹œêµ¬ì—ê²Œ ë¨¼ì € ë§ì„ ê±¸ê±°ë‚˜, ê°ˆë“±ì„ ëŒ€í™”ë¡œ í’€ì–´ ë³´ë ¤ëŠ” ì—°ìŠµì„ í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤.");
    if(underScore<=2) improves.push("ë°œë‹¬ê³¼ ê´€ë ¨ëœ ìƒí™©ì„ ë‹¤ì‹œ í•œ ë²ˆ ì •ë¦¬í•´ ë³´ê³ , ì¹œêµ¬ë¥¼ ë†€ë¦¬ì§€ ì•ŠëŠ” íƒœë„ë¥¼ ë” ê°•í™”í•˜ë©´ ì¢‹ê² ì–´ìš”.");
    if(habitScore<=22) improves.push("ìˆ˜ë©´Â·ìš´ë™Â·ë¯¸ë””ì–´ ì‚¬ìš© ì¤‘ í•œ ê°€ì§€ë¥¼ ê³¨ë¼, ì¼ì£¼ì¼ë§Œì´ë¼ë„ ì¡°ê¸ˆì”© ë°”ê¿” ë³´ëŠ” ì—°ìŠµì„ í•´ ë³´ë©´ ì¢‹ìŠµë‹ˆë‹¤.");

    while(strengths.length<3){
      strengths.push("ìŠ¤ìŠ¤ë¡œë¥¼ ëŒì•„ë³´ê³ ì í•˜ëŠ” ë§ˆìŒ ìì²´ê°€ í° ê°•ì ì´ì—ìš”.");
    }
    while(improves.length<2){
      improves.push("ì‘ì€ ëª©í‘œë¶€í„° ì •í•˜ê³  ì²œì²œíˆ ì‹¤ì²œí•´ ë³´ë©´ ì¢‹ì•„ìš”.");
    }
    return {strengths:strengths.slice(0,3),improves:improves.slice(0,2)};
  }

  function buildImagePrompt(domainScores,underScore,habitScore){
    let mood="ë°ê³  ê±´ê°•í•œ";
    if(habitScore<15 || underScore<=2) mood="ì¡°ê¸ˆ ìƒê°ì— ì ê¸´ í‘œì •ì´ì§€ë§Œ ì„±ì¥ ê°€ëŠ¥ì„±ì´ ëŠê»´ì§€ëŠ”";
    else if(domainScores.emotional>=3 && domainScores.social>=3) mood="ë¯¸ì†Œë¥¼ ì§“ê³  ì¹œêµ¬ë“¤ì—ê²Œ ì¹œê·¼í•œ ëŠë‚Œì˜";
    const txt = mood+" ì´ˆë“±í•™êµ 5í•™ë…„ í•™ìƒ ìºë¦­í„° ì „ì‹  ì¼ëŸ¬ìŠ¤íŠ¸.\në¶€ë“œëŸ¬ìš´ íŒŒìŠ¤í…” í†¤ì˜ êµì‹¤ ë°°ê²½.\nì‹ ì²´, ìƒê°, ê°ì •, ì‚¬íšŒì„±ì´ í•¨ê»˜ ìë¼ëŠ” ë”°ëœ»í•œ ë¶„ìœ„ê¸°.\ní•œêµ­ ì´ˆë“±í•™êµ êµê³¼ì„œ ì‚½í™” ìŠ¤íƒ€ì¼, ë„ˆë¬´ ë³µì¡í•˜ì§€ ì•Šì€ ê·¸ë¦¼.";
    return txt;
  }

  function renderResult(){
    const scores = getDomainScores();
    const underScore = getUnderstandingScore();
    const habitScore = getHabitScore();

    const bars = qs("domainBars");
    bars.innerHTML="";
    Object.keys(scores).forEach(k=>{
      const row=document.createElement("div");
      row.className="domain-bar-row";
      const label=document.createElement("span");
      label.textContent = domainsMeta[k].emoji+" "+domainsMeta[k].label;
      const dots=document.createElement("span");
      dots.className="dots";
      let d="";
      for(let i=0;i<4;i++) d+= i<scores[k] ? "â—" : "â—‹";
      dots.textContent=d;
      row.appendChild(label);row.appendChild(dots);
      bars.appendChild(row);
    });

    const domText = Object.keys(scores).map(k=>getDomainText(k,scores[k])).join("\n\n");
    qs("domainAnalysis").textContent = domText;
    qs("understandingAnalysis").textContent = getUnderstandingText(underScore);
    qs("habitAnalysis").textContent = getHabitText(habitScore);

    const si = buildStrengthsAndImprovements(scores,underScore,habitScore);
    qs("strengthList").textContent = si.strengths.map(s=>"Â· "+s).join("\n");
    qs("improveList").textContent = si.improves.map(s=>"Â· "+s).join("\n");

    qs("imagePrompt").value = buildImagePrompt(scores,underScore,habitScore);
    qs("copyStatus").textContent = "";
  }

  function goNext(){
    if(currentStep===1){
      if(step1Checked.size===0){
        const ok = confirm("ì•„ì§ ì²´í¬í•œ ë¬¸í•­ì´ ì—†ì–´ìš”. ê·¸ë˜ë„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°ˆê¹Œìš”?");
        if(!ok) return;
      }
      currentStep=2;
    }else if(currentStep===2){
      if(quizAnswers.some(v=>v===null)){
        const ok = confirm("í’€ì§€ ì•Šì€ ë¬¸ì œê°€ ìˆì–´ìš”. ê·¸ë˜ë„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°ˆê¹Œìš”?");
        if(!ok) return;
      }
      currentStep=3;
    }else if(currentStep===3){
      currentStep=4;
      renderResult();
    }else{
      currentStep=1;
    }
    updateStepper();
  }

  function goPrev(){
    if(currentStep>1){
      currentStep--;
      updateStepper();
    }
  }

  function init(){
    renderStep1();
    renderQuiz();
    renderHabits();
    updateStepper();

    qs("btnNext").addEventListener("click",goNext);
    qs("btnPrev").addEventListener("click",goPrev);

    document.addEventListener("keydown",function(e){
      if(currentStep!==2) return;
      if(e.key==="ArrowRight" && quizIndex<quizData.length-1){
        quizIndex++;renderQuiz();
      }else if(e.key==="ArrowLeft" && quizIndex>0){
        quizIndex--;renderQuiz();
      }
    });

    qs("btnCopy").addEventListener("click",function(){
      const txt = qs("imagePrompt").value;
      if(!navigator.clipboard){
        qs("copyStatus").textContent="ë³µì‚¬ê°€ ì˜ ì•ˆ ë˜ë©´ ì§ì ‘ ë“œë˜ê·¸í•´ì„œ ë³µì‚¬í•´ ì£¼ì„¸ìš”.";
        return;
      }
      navigator.clipboard.writeText(txt).then(function(){
        qs("copyStatus").textContent="í”„ë¡¬í”„íŠ¸ë¥¼ ë³µì‚¬í–ˆì–´ìš”. ChatGPT ì´ë¯¸ì§€ ë§Œë“¤ê¸°ì— ë¶™ì—¬ë„£ì–´ ë³´ì„¸ìš”.";
      }).catch(function(){
        qs("copyStatus").textContent="ë³µì‚¬ê°€ ì˜ ì•ˆ ë˜ë©´ ì§ì ‘ ë“œë˜ê·¸í•´ì„œ ë³µì‚¬í•´ ì£¼ì„¸ìš”.";
      });
    });
  }

  document.addEventListener("DOMContentLoaded",init);
})();
</script>
</body>
</html>
